{"version":3,"sources":["../src/Plot2D.tsx","../src/context.ts","../src/utils.ts","../src/Axes2D.tsx","../src/Parametric2D.tsx","../src/Polygon2D.tsx","../src/Arc.tsx","../src/Label.tsx","../src/Line.tsx","../src/Function2D.tsx","../src/Point2D.tsx","../src/Scatter2D.tsx","../src/Ray2D.tsx","../src/Vector2D.tsx","../src/Polyline2D.tsx","../src/Bezier2D.tsx","../src/Area2D.tsx","../src/RiemannSum.tsx","../src/TangentLine.tsx","../src/NormalLine.tsx","../src/AngleMarker.tsx","../src/DistanceMarker.tsx","../src/VectorField2D.tsx","../src/Heatmap2D.tsx","../src/Implicit2D.tsx","../src/Contour2D.tsx","../src/PolarFunction2D.tsx","../src/Crosshair2D.tsx","../src/Legend2D.tsx","../src/Title2D.tsx","../src/LinearGradient2D.tsx","../src/RadialGradient2D.tsx","../src/Image2D.tsx","../src/Plot3D.tsx","../src/threeContext.ts","../src/Axes3D.tsx","../src/threeParent.ts","../src/Grid3D.tsx","../src/Box3D.tsx","../src/Sphere3D.tsx","../src/Label3D.tsx","../src/Legend3D.tsx","../src/Torus3D.tsx","../src/Cylinder3D.tsx","../src/Cone3D.tsx","../src/Surface3D.tsx","../src/ParametricSurface3D.tsx","../src/Scatter3D.tsx","../src/useAnimation.ts","../src/Group3D.tsx","../src/easing.ts","../src/useTween.ts","../src/Animate2D.tsx","../src/Animate3D.tsx"],"sourcesContent":["import React from \"react\";\nimport { PlotContext, Margins, Range } from \"./context\";\nimport { makeLinearMapper } from \"./utils\";\n\nexport type Plot2DProps = {\n  width: number;\n  height: number;\n  xRange: Range;\n  yRange: Range;\n  margin?: Partial<Margins>;\n  children: React.ReactNode;\n  style?: React.CSSProperties;\n  className?: string;\n  // Interactions\n  pannable?: boolean; // enable drag-to-pan with mouse/touch (defaults to true)\n  onViewportChange?: (xRange: Range, yRange: Range) => void; // called whenever viewport changes due to interactions\n  zoomable?: boolean; // enable wheel-zoom centered at cursor\n  zoomSpeed?: number; // zoom multiplier per wheel step (e.g., 1.1)\n  pinchZoomable?: boolean; // enable two-finger pinch zoom on touch devices (defaults to true)\n};\n\nexport function Plot2D({\n  width,\n  height,\n  xRange,\n  yRange,\n  margin,\n  children,\n  style,\n  className,\n  pannable = true,\n  onViewportChange,\n  zoomable = true,\n  zoomSpeed = 1.1,\n  pinchZoomable = true,\n}: Plot2DProps) {\n  const wrapperRef = React.useRef<HTMLDivElement | null>(null);\n  const svgRef = React.useRef<SVGSVGElement | null>(null);\n  const m: Margins = {\n    top: margin?.top ?? 20,\n    right: margin?.right ?? 20,\n    bottom: margin?.bottom ?? 30,\n    left: margin?.left ?? 40,\n  };\n\n  const innerWidth = Math.max(0, width - m.left - m.right);\n  const innerHeight = Math.max(0, height - m.top - m.bottom);\n\n  // Viewport state (supports controlled via props and interactive panning)\n  const [curXRange, setCurXRange] = React.useState<Range>(xRange);\n  const [curYRange, setCurYRange] = React.useState<Range>(yRange);\n\n  // Keep local state in sync if parent updates props\n  React.useEffect(() => {\n    setCurXRange(xRange);\n  }, [xRange[0], xRange[1]]);\n  React.useEffect(() => {\n    setCurYRange(yRange);\n  }, [yRange[0], yRange[1]]);\n\n  const xMap = makeLinearMapper(curXRange[0], curXRange[1], 0, innerWidth);\n  const yMap = makeLinearMapper(curYRange[0], curYRange[1], innerHeight, 0);\n\n  const worldToScreen = (x: number, y: number) => ({\n    x: m.left + xMap.f(x),\n    y: m.top + yMap.f(y),\n  });\n  const screenToWorld = (sx: number, sy: number) => ({\n    x: xMap.inv(sx - m.left),\n    y: yMap.inv(sy - m.top),\n  });\n\n  // Use state ref for overlay to ensure portal mount triggers re-render\n  const [overlayEl, setOverlayEl] = React.useState<HTMLDivElement | null>(null);\n  const clipPathId = (React as any).useId ? React.useId() : 'clip-' + Math.random().toString(36).slice(2);\n\n  // Panning interaction\n  const panState = React.useRef<{\n    active: boolean;\n    startX: number;\n    startY: number;\n    startXRange: Range;\n    startYRange: Range;\n    startSX: number;\n    startSY: number;\n    startMouseWorldX: number;\n    startMouseWorldY: number;\n  }>({ active: false, startX: 0, startY: 0, startXRange: [0, 1], startYRange: [0, 1], startSX: 0, startSY: 0, startMouseWorldX: 0, startMouseWorldY: 0 });\n\n  const pxPerUnitX = innerWidth > 0 ? innerWidth / Math.max(1e-12, (curXRange[1] - curXRange[0])) : 1;\n  const pxPerUnitY = innerHeight > 0 ? innerHeight / Math.max(1e-12, (curYRange[1] - curYRange[0])) : 1;\n\n  // Multi-touch tracking for pinch zoom\n  const pointersRef = React.useRef<Map<number, { clientX:number; clientY:number }>>(new Map());\n  const pinchRef = React.useRef<{ active:boolean; lastDist:number; lastCenter:{sx:number; sy:number; x:number; y:number} | null }>({ active:false, lastDist:0, lastCenter:null });\n\n  const onPointerDown = React.useCallback((e: React.PointerEvent<SVGRectElement>) => {\n    // Allow touch/pen pointers for pinch even when pannable=false\n    if (e.pointerType === 'mouse') {\n      if (!pannable) return; // don't start pan with mouse if pannable is disabled\n      if (e.button !== 0) return; // only primary button\n    }\n    const target = e.currentTarget as SVGRectElement;\n    try { (target as any).setPointerCapture?.(e.pointerId); } catch {}\n    // Track pointer for potential pinch\n    pointersRef.current.set(e.pointerId, { clientX: e.clientX, clientY: e.clientY });\n    const svgEl = (e.currentTarget as any).ownerSVGElement as SVGSVGElement | null;\n    // Helper para convertir coordenadas de ventana a coordenadas del SVG usando la matriz actual (robusto ante transform CSS)\n    const clientToSvg = (clientX:number, clientY:number) => {\n      if (!svgEl) return { x: clientX, y: clientY };\n      const pt = svgEl.createSVGPoint();\n      pt.x = clientX;\n      pt.y = clientY;\n      const ctm = svgEl.getScreenCTM();\n      if (!ctm) return { x: clientX, y: clientY };\n      const inv = ctm.inverse();\n      const svgP = pt.matrixTransform(inv);\n      return { x: svgP.x, y: svgP.y };\n    };\n    if (pinchZoomable && pointersRef.current.size >= 2) {\n      // Initialize pinch state\n      if (svgEl) {\n        const pts = Array.from(pointersRef.current.values());\n        const p0 = pts[0], p1 = pts[1];\n        const midX = (p0.clientX + p1.clientX) / 2;\n        const midY = (p0.clientY + p1.clientY) / 2;\n        const svgMid = clientToSvg(midX, midY);\n        const sx = svgMid.x;\n        const sy = svgMid.y;\n        const w = screenToWorld(sx, sy);\n        const dx = (p0.clientX - p1.clientX);\n        const dy = (p0.clientY - p1.clientY);\n        const dist = Math.hypot(dx, dy);\n        pinchRef.current = { active:true, lastDist: Math.max(1e-6, dist), lastCenter: { sx, sy, x: w.x, y: w.y } };\n        // Ensure pan is not active while pinching\n        panState.current.active = false;\n      }\n    } else if (pannable) {\n      // Start a pan gesture\n      panState.current = {\n        active: true,\n        startX: e.clientX,\n        startY: e.clientY,\n        startXRange: curXRange,\n        startYRange: curYRange,\n        // Guardamos también coordenadas SVG iniciales para pan correcto bajo transformaciones\n        startSX: (() => { const p = svgEl ? (() => { const pt = svgEl.createSVGPoint(); pt.x = e.clientX; pt.y = e.clientY; const ctm = svgEl.getScreenCTM(); if (!ctm) return pt; return pt.matrixTransform(ctm.inverse()); })() : { x: e.clientX, y: e.clientY }; return p.x; })(),\n        startSY: (() => { const p = svgEl ? (() => { const pt = svgEl.createSVGPoint(); pt.x = e.clientX; pt.y = e.clientY; const ctm = svgEl.getScreenCTM(); if (!ctm) return pt; return pt.matrixTransform(ctm.inverse()); })() : { x: e.clientX, y: e.clientY }; return p.y; })(),\n        startMouseWorldX: (() => { const invP = (() => { if (!svgEl) return { x: e.clientX, y: e.clientY }; const pt = svgEl.createSVGPoint(); pt.x = e.clientX; pt.y = e.clientY; const ctm = svgEl.getScreenCTM(); return ctm ? pt.matrixTransform(ctm.inverse()) : { x: e.clientX, y: e.clientY }; })(); return screenToWorld(invP.x, invP.y).x; })(),\n        startMouseWorldY: (() => { const invP = (() => { if (!svgEl) return { x: e.clientX, y: e.clientY }; const pt = svgEl.createSVGPoint(); pt.x = e.clientX; pt.y = e.clientY; const ctm = svgEl.getScreenCTM(); return ctm ? pt.matrixTransform(ctm.inverse()) : { x: e.clientX, y: e.clientY }; })(); return screenToWorld(invP.x, invP.y).y; })(),\n      };\n      frozenLabelRef.current = { x: panState.current.startMouseWorldX, y: panState.current.startMouseWorldY };\n    }\n  }, [pannable, curXRange, curYRange, pinchZoomable]);\n\n  const onPointerMove = React.useCallback((e: React.PointerEvent<SVGRectElement>) => {\n    // update mouse state always (compute immediately to avoid React event pooling issues)\n    const svgEl = (e.currentTarget as any).ownerSVGElement as SVGSVGElement | null;\n    if (svgEl) {\n      const pt = svgEl.createSVGPoint();\n      pt.x = e.clientX; pt.y = e.clientY;\n      const ctm = svgEl.getScreenCTM();\n      let svgP = { x: e.clientX, y: e.clientY };\n      if (ctm) svgP = pt.matrixTransform(ctm.inverse());\n      const sx = svgP.x;\n      const sy = svgP.y;\n      const w = screenToWorld(sx, sy);\n      if (panState.current.active && frozenLabelRef.current) {\n        setMouse({ sx, sy, x: frozenLabelRef.current.x, y: frozenLabelRef.current.y, inside: true });\n      } else {\n        setMouse({ sx, sy, x: w.x, y: w.y, inside: true });\n      }\n    }\n    // Pinch handling (two fingers)\n    if (pinchRef.current.active && pinchZoomable) {\n      const svgEl2 = (e.currentTarget as any).ownerSVGElement as SVGSVGElement | null;\n      if (svgEl2) {\n        if (pointersRef.current.has(e.pointerId)) {\n          pointersRef.current.set(e.pointerId, { clientX: e.clientX, clientY: e.clientY });\n        }\n        if (pointersRef.current.size >= 2) {\n          const pts = Array.from(pointersRef.current.values());\n          const p0 = pts[0], p1 = pts[1];\n          const midX = (p0.clientX + p1.clientX) / 2;\n          const midY = (p0.clientY + p1.clientY) / 2;\n          const pt2 = svgEl2.createSVGPoint(); pt2.x = midX; pt2.y = midY;\n          const ctm2 = svgEl2.getScreenCTM();\n          let svgMid = { x: midX, y: midY };\n          if (ctm2) svgMid = pt2.matrixTransform(ctm2.inverse());\n          const sx = svgMid.x;\n          const sy = svgMid.y;\n          const w = screenToWorld(sx, sy);\n          const dx = (p0.clientX - p1.clientX);\n          const dy = (p0.clientY - p1.clientY);\n          const dist = Math.max(1e-6, Math.hypot(dx, dy));\n          const s = dist / Math.max(1e-6, pinchRef.current.lastDist);\n          // Scale current ranges around current finger center\n          let nx: Range = [ w.x + (curXRange[0] - w.x) / s, w.x + (curXRange[1] - w.x) / s ];\n          let ny: Range = [ w.y + (curYRange[0] - w.y) / s, w.y + (curYRange[1] - w.y) / s ];\n          // Translate ranges to keep the world point under the fingers stationary\n          if (pinchRef.current.lastCenter) {\n            const dxw = pinchRef.current.lastCenter.x - w.x;\n            const dyw = pinchRef.current.lastCenter.y - w.y;\n            nx = [ nx[0] + dxw, nx[1] + dxw ];\n            ny = [ ny[0] + dyw, ny[1] + dyw ];\n          }\n          setCurXRange(nx);\n          setCurYRange(ny);\n          onViewportChange?.(nx, ny);\n          pinchRef.current.lastDist = dist;\n          pinchRef.current.lastCenter = { sx, sy, x: w.x, y: w.y };\n          setMouse({ sx, sy, x: w.x, y: w.y, inside: true });\n        }\n      }\n      return;\n    }\n    if (!panState.current.active) return;\n    const svgEl3 = (e.currentTarget as any).ownerSVGElement as SVGSVGElement | null;\n    let curSX = e.clientX, curSY = e.clientY;\n    if (svgEl3) {\n      const pt3 = svgEl3.createSVGPoint(); pt3.x = e.clientX; pt3.y = e.clientY;\n      const ctm3 = svgEl3.getScreenCTM();\n      if (ctm3) {\n        const svgP3 = pt3.matrixTransform(ctm3.inverse());\n        curSX = svgP3.x; curSY = svgP3.y;\n      }\n    }\n    const dxPxSvg = curSX - (panState.current as any).startSX;\n    const dyPxSvg = curSY - (panState.current as any).startSY;\n    const dxWorld = (dxPxSvg) / Math.max(1e-12, pxPerUnitX);\n    const dyWorld = -(dyPxSvg) / Math.max(1e-12, pxPerUnitY);\n    const nx: Range = [\n      panState.current.startXRange[0] - dxWorld,\n      panState.current.startXRange[1] - dxWorld,\n    ];\n    const ny: Range = [\n      panState.current.startYRange[0] - dyWorld,\n      panState.current.startYRange[1] - dyWorld,\n    ];\n    setCurXRange(nx);\n    setCurYRange(ny);\n    onViewportChange?.(nx, ny);\n  }, [pxPerUnitX, pxPerUnitY, onViewportChange]);\n\n  const endPan = React.useCallback((e?: React.PointerEvent<SVGRectElement>) => {\n    if (e) {\n      try { (e.currentTarget as any).releasePointerCapture?.(e.pointerId); } catch {}\n      pointersRef.current.delete((e as any).pointerId);\n    }\n    // End pan if it was active\n    panState.current.active = false;\n    frozenLabelRef.current = null;\n    // If pinch loses fingers, end pinch\n    if (pinchRef.current.active && pointersRef.current.size < 2) {\n      pinchRef.current.active = false;\n      pinchRef.current.lastCenter = null;\n      pinchRef.current.lastDist = 0;\n    }\n  }, []);\n\n  // Mouse state for crosshair/tooltip\n  const [mouse, setMouse] = React.useState<{ sx:number; sy:number; x:number; y:number; inside:boolean }>({ sx: 0, sy: 0, x: 0, y: 0, inside: false });\n  // Freeze label world coords during active pan so displayed numbers don't change while dragging\n  const frozenLabelRef = React.useRef<{ x:number; y:number } | null>(null);\n\n  const onPointerLeaveArea = React.useCallback((e: React.PointerEvent<SVGRectElement>) => {\n    endPan(e);\n    setMouse(m => ({ ...m, inside: false }));\n  }, [endPan]);\n\n  // React onWheel handler removed to avoid passive listener preventDefault warnings.\n\n  // Native wheel handler on the wrapper to fully prevent page zoom/scroll (non-passive)\n  React.useEffect(() => {\n    const el = wrapperRef.current;\n    if (!el) return;\n    const handler = (e: WheelEvent) => {\n      if (!zoomable) return;\n      // Prevent default to avoid page scroll and browser zoom (ctrl+wheel / pinch-zoom on trackpad)\n      e.preventDefault();\n      const svg = svgRef.current;\n      if (!svg) return;\n      // Usar matriz inversa del SVG para coordenadas exactas bajo cualquier transform\n      const pt = svg.createSVGPoint();\n      pt.x = e.clientX; pt.y = e.clientY;\n      const ctm = svg.getScreenCTM();\n      let svgP = { x: e.clientX, y: e.clientY };\n      if (ctm) svgP = pt.matrixTransform(ctm.inverse());\n      const sx = svgP.x;\n      const sy = svgP.y;\n      const w = screenToWorld(sx, sy);\n      const zx = e.deltaY < 0 ? (1 / zoomSpeed) : zoomSpeed;\n      const zy = zx; // future: independent zoom per axis\n      const nx: Range = [\n        w.x + (curXRange[0] - w.x) * zx,\n        w.x + (curXRange[1] - w.x) * zx,\n      ];\n      const ny: Range = [\n        w.y + (curYRange[0] - w.y) * zy,\n        w.y + (curYRange[1] - w.y) * zy,\n      ];\n      setCurXRange(nx);\n      setCurYRange(ny);\n      onViewportChange?.(nx, ny);\n      setMouse({ sx, sy, x: w.x, y: w.y, inside: true });\n    };\n    el.addEventListener('wheel', handler, { passive: false });\n    return () => el.removeEventListener('wheel', handler as any);\n  }, [zoomable, zoomSpeed, curXRange[0], curXRange[1], curYRange[0], curYRange[1], screenToWorld, onViewportChange]);\n\n  const ctxValue = React.useMemo(\n    () => ({\n      width,\n      height,\n      innerWidth,\n      innerHeight,\n      margin: m,\n      xRange: curXRange,\n      yRange: curYRange,\n      worldToScreen,\n      screenToWorld,\n      htmlOverlay: overlayEl,\n      clipPathId,\n      mouse,\n    }),\n    [width, height, innerWidth, innerHeight, m.top, m.right, m.bottom, m.left, curXRange[0], curXRange[1], curYRange[0], curYRange[1], overlayEl, clipPathId, mouse?.sx, mouse?.sy, mouse?.x, mouse?.y, mouse?.inside]\n  );\n\n  return (\n    <div\n      ref={wrapperRef}\n      className={className}\n  style={{ position: \"relative\", width, height, overscrollBehavior: 'contain', touchAction: (pannable || zoomable || pinchZoomable) ? 'none' as any : 'auto', ...style }}\n    >\n      <svg ref={svgRef} width={width} height={height} style={{ position: \"absolute\", inset: 0 }}>\n        <defs>\n          <clipPath id={clipPathId}>\n            <rect x={m.left} y={m.top} width={innerWidth} height={innerHeight} />\n          </clipPath>\n        </defs>\n        <PlotContext.Provider value={ctxValue}>\n          <g>{children}</g>\n          {/* Pan capture rect over plotting area */}\n          <rect\n            x={m.left}\n            y={m.top}\n            width={innerWidth}\n            height={innerHeight}\n            fill=\"transparent\"\n            style={{ cursor: pannable ? (panState.current.active ? 'grabbing' : 'grab') : 'default', touchAction: (pannable || pinchZoomable) ? 'none' as any : 'auto' as any }}\n            onPointerDown={onPointerDown}\n            onPointerMove={onPointerMove}\n            onPointerUp={endPan}\n            onPointerCancel={endPan}\n            onPointerLeave={onPointerLeaveArea}\n          />\n        </PlotContext.Provider>\n      </svg>\n      <div\n        ref={setOverlayEl}\n        style={{ position: \"absolute\", inset: 0, pointerEvents: \"none\", fontFamily: \"system-ui, Segoe UI, Roboto, sans-serif\", fontSize: 12, color: \"#222\" }}\n      />\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport type Range = [number, number];\n\nexport type Margins = {\n  top: number;\n  right: number;\n  bottom: number;\n  left: number;\n};\n\nexport type PlotContextType = {\n  width: number;\n  height: number;\n  innerWidth: number;\n  innerHeight: number;\n  margin: Margins;\n  xRange: Range;\n  yRange: Range;\n  worldToScreen: (x: number, y: number) => { x: number; y: number };\n  screenToWorld: (x: number, y: number) => { x: number; y: number };\n  htmlOverlay: HTMLDivElement | null;\n  clipPathId: string;\n  mouse?: { sx: number; sy: number; x: number; y: number; inside: boolean };\n};\n\nexport const PlotContext = React.createContext<PlotContextType | null>(null);\nexport const usePlot = () => {\n  const ctx = React.useContext(PlotContext);\n  if (!ctx) throw new Error(\"This component must be used inside <Plot2D />\");\n  return ctx;\n};\n","export function makeLinearMapper(\n  domainMin: number,\n  domainMax: number,\n  rangeMin: number,\n  rangeMax: number\n) {\n  const span = domainMax - domainMin || 1e-9;\n  const k = (rangeMax - rangeMin) / span;\n  return {\n    f: (x: number) => rangeMin + (x - domainMin) * k,\n    inv: (y: number) => domainMin + (y - rangeMin) / k,\n  };\n}\n\nexport function niceStep(span: number, approxCount: number) {\n  const raw = span / Math.max(1, approxCount);\n  const pow10 = Math.pow(10, Math.floor(Math.log10(Math.abs(raw))));\n  const base = raw / pow10;\n  let nice;\n  if (base >= 10) nice = 10;\n  else if (base >= 5) nice = 5;\n  else if (base >= 2) nice = 2;\n  else if (base >= 1) nice = 1;\n  else if (base >= 0.5) nice = 0.5;\n  else nice = 0.2;\n  return nice * pow10;\n}\n\nexport function generateTicks(\n  min: number,\n  max: number,\n  approxCount: number\n): number[] {\n  if (!(isFinite(min) && isFinite(max))) return [];\n  if (min === max) return [min];\n  const step = niceStep(max - min, approxCount);\n  const eps = 1e-12;\n  // If the range crosses zero, anchor ticks at 0 and step outwards\n  if (min <= 0 && 0 <= max) {\n    const ticks: number[] = [0];\n    // Positive direction\n    for (let t = step; t <= max + eps; t += step) {\n      const val = Math.abs(t) < eps ? 0 : t;\n      ticks.push(Number(val.toFixed(12)));\n    }\n    // Negative direction\n    for (let t = -step; t >= min - eps; t -= step) {\n      const val = Math.abs(t) < eps ? 0 : t;\n      ticks.push(Number(val.toFixed(12)));\n    }\n    // Sort and dedupe\n    const uniq = Array.from(new Set(ticks.map((v) => Number(v.toFixed(12))))).sort((a, b) => a - b);\n    return uniq;\n  } else {\n    // Otherwise fall back to starting at the first tick >= min\n    const start = Math.ceil(min / step) * step;\n    const ticks: number[] = [];\n    for (let t = start; t <= max + eps; t += step) {\n      const val = Math.abs(t) < eps ? 0 : t;\n      ticks.push(Number(val.toFixed(12)));\n    }\n    return ticks;\n  }\n}\n\nexport function pathFromPoints(points: Array<{ x: number; y: number }>) {\n  if (points.length === 0) return \"\";\n  const [p0, ...rest] = points;\n  return 'M ' + p0.x + ' ' + p0.y + ' ' + rest.map((p) => 'L ' + p.x + ' ' + p.y).join(' ');\n}\n\n// Generate ticks using a fixed delta and an anchor (default 0).\n// If the range contains the anchor, produce symmetric ticks around it.\n// Otherwise, start from the smallest multiple of delta greater than min.\nexport function generateTicksFromDelta(\n  min: number,\n  max: number,\n  delta: number,\n  anchor = 0\n): number[] {\n  if (!(isFinite(min) && isFinite(max) && isFinite(delta))) return [];\n  const d = Math.abs(delta) || 1e-9;\n  const eps = 1e-12;\n\n  if (min <= anchor && anchor <= max) {\n    const ticks: number[] = [anchor];\n    for (let t = anchor + d; t <= max + eps; t += d) ticks.push(Number((Math.abs(t) < eps ? 0 : t).toFixed(12)));\n    for (let t = anchor - d; t >= min - eps; t -= d) ticks.push(Number((Math.abs(t) < eps ? 0 : t).toFixed(12)));\n    const uniq = Array.from(new Set(ticks.map((v) => Number(v.toFixed(12))))).sort((a, b) => a - b);\n    return uniq;\n  } else {\n    const kStart = Math.ceil((min - anchor) / d);\n    const start = anchor + kStart * d;\n    const ticks: number[] = [];\n    for (let t = start; t <= max + eps; t += d) ticks.push(Number((Math.abs(t) < eps ? 0 : t).toFixed(12)));\n    return ticks;\n  }\n}\n","import React from \"react\";\nimport { usePlot } from \"./context\";\nimport { generateTicks, generateTicksFromDelta } from \"./utils\";\n\nexport type Axes2DProps = {\n  grid?: boolean | { stroke?: string; strokeWidth?: number; opacity?: number };\n  minorGrid?: boolean | { stroke?: string; strokeWidth?: number; opacity?: number };\n  xSubdivisions?: number; // number of minor divisions between consecutive major x ticks\n  ySubdivisions?: number; // number of minor divisions between consecutive major y ticks\n  gridMajorPx?: number | { x?: number; y?: number }; // target pixel spacing between major grid lines\n  minMinorPx?: number; // minimum pixel spacing for minor grid lines; auto-reduce subdivisions if needed\n  gridXDelta?: number; // explicit major grid step for X (world units)\n  gridYDelta?: number; // explicit major grid step for Y (world units)\n  xTicks?: number[];\n  yTicks?: number[];\n  approxXTicks?: number;\n  approxYTicks?: number;\n  axisColor?: string;\n  axisWidth?: number;\n  tickSize?: number;\n  renderXLabel?: (x: number) => React.ReactNode | null;\n  renderYLabel?: (y: number) => React.ReactNode | null;\n  labelOffset?: { x?: number; y?: number };\n};\n\nexport function Axes2D({\n  grid = false,\n  minorGrid = false,\n  xSubdivisions = 0,\n  ySubdivisions = 0,\n  gridMajorPx = 80,\n  minMinorPx = 14,\n  gridXDelta,\n  gridYDelta,\n  xTicks,\n  yTicks,\n  approxXTicks = 9,\n  approxYTicks = 7,\n  axisColor = \"#333\",\n  axisWidth = 1,\n  tickSize = 6,\n  renderXLabel,\n  renderYLabel,\n  labelOffset = { x: 12, y: 8 },\n}: Axes2DProps) {\n  const { xRange, yRange, worldToScreen, clipPathId, innerWidth, innerHeight, margin } = usePlot();\n\n  let xTickVals: number[] = [];\n  let yTickVals: number[] = [];\n\n  const inferDelta = (vals: number[]) => {\n    const uniq = Array.from(new Set(vals)).sort((a, b) => a - b);\n    let best = Infinity;\n    for (let i = 1; i < uniq.length; i++) {\n      const d = Math.abs(uniq[i] - uniq[i - 1]);\n      if (d > 1e-12 && d < best) best = d;\n    }\n    return isFinite(best) ? best : undefined;\n  };\n\n  const xDeltaInferred = xTicks && xTicks.length >= 2 ? inferDelta(xTicks) : undefined;\n  const yDeltaInferred = yTicks && yTicks.length >= 2 ? inferDelta(yTicks) : undefined;\n  const xDeltaBase = typeof gridXDelta === 'number' && gridXDelta > 0 ? gridXDelta : xDeltaInferred;\n  const yDeltaBase = typeof gridYDelta === 'number' && gridYDelta > 0 ? gridYDelta : yDeltaInferred;\n\n  const p00 = worldToScreen(0, 0);\n  const p10 = worldToScreen(1, 0);\n  const p01 = worldToScreen(0, 1);\n  const pxPerUnitX = Math.max(1e-9, Math.abs(p10.x - p00.x));\n  const pxPerUnitY = Math.max(1e-9, Math.abs(p01.y - p00.y));\n  const targetMajorPxX = typeof gridMajorPx === 'number' ? gridMajorPx : (gridMajorPx.x ?? 80);\n  const targetMajorPxY = typeof gridMajorPx === 'number' ? gridMajorPx : (gridMajorPx.y ?? 80);\n  const clamp = (v: number, a: number, b: number) => Math.max(a, Math.min(b, v));\n\n  const coarsenDelta = (delta: number | undefined, pxPerUnit: number, targetPx: number) => {\n    if (!delta || !(delta > 0)) return undefined;\n    let d = delta;\n    const factors = [2, 2.5, 2];\n    let fi = 0;\n    let guard = 0;\n    while (pxPerUnit * d < targetPx && guard < 20) {\n      d *= factors[fi % factors.length];\n      fi += 1;\n      guard += 1;\n    }\n    return d;\n  };\n\n  const approxCountX = clamp(Math.round(innerWidth / targetMajorPxX), 2, 40);\n  const approxCountY = clamp(Math.round(innerHeight / targetMajorPxY), 2, 40);\n\n  const xDeltaCoarse = typeof gridXDelta === 'number' && gridXDelta > 0 ? gridXDelta : coarsenDelta(xDeltaBase, pxPerUnitX, targetMajorPxX);\n  const yDeltaCoarse = typeof gridYDelta === 'number' && gridYDelta > 0 ? gridYDelta : coarsenDelta(yDeltaBase, pxPerUnitY, targetMajorPxY);\n\n  const gridXMajor = xDeltaCoarse ? generateTicksFromDelta(xRange[0], xRange[1], xDeltaCoarse, 0) : generateTicks(xRange[0], xRange[1], approxCountX);\n  const gridYMajor = yDeltaCoarse ? generateTicksFromDelta(yRange[0], yRange[1], yDeltaCoarse, 0) : generateTicks(yRange[0], yRange[1], approxCountY);\n\n  const gridXMajorFinal = xDeltaBase && gridXMajor.length <= 1 ? generateTicks(xRange[0], xRange[1], approxCountX) : gridXMajor;\n  const gridYMajorFinal = yDeltaBase && gridYMajor.length <= 1 ? generateTicks(yRange[0], yRange[1], approxCountY) : gridYMajor;\n\n  if (xTicks && xTicks.length) xTickVals = xTicks;\n  else if (typeof gridXDelta === 'number' && gridXDelta > 0) xTickVals = gridXMajorFinal;\n  else xTickVals = generateTicks(xRange[0], xRange[1], approxXTicks);\n\n  if (yTicks && yTicks.length) yTickVals = yTicks;\n  else if (typeof gridYDelta === 'number' && gridYDelta > 0) yTickVals = gridYMajorFinal;\n  else yTickVals = generateTicks(yRange[0], yRange[1], approxYTicks);\n\n  const segMinMinorSubs = (majors: number[], desired: number, pxPerUnit: number) => {\n    if (!desired || majors.length < 2) return 0;\n    let maxSubs = Infinity;\n    for (let i = 1; i < majors.length; i++) {\n      const seg = Math.abs(majors[i] - majors[i - 1]);\n      const segPx = pxPerUnit * seg;\n      const allowed = Math.floor(segPx / Math.max(1, minMinorPx)) - 1;\n      if (allowed < maxSubs) maxSubs = allowed;\n    }\n    return Math.max(0, Math.min(desired, isFinite(maxSubs) ? maxSubs : 0));\n  };\n\n  const xSubEff = segMinMinorSubs(gridXMajorFinal, xSubdivisions, pxPerUnitX);\n  const ySubEff = segMinMinorSubs(gridYMajorFinal, ySubdivisions, pxPerUnitY);\n\n  const zeroXInRange = xRange[0] <= 0 && 0 <= xRange[1];\n  const zeroYInRange = yRange[0] <= 0 && 0 <= yRange[1];\n\n  const axisYValue = zeroYInRange ? 0 : (Math.abs(yRange[0]) <= Math.abs(yRange[1]) ? yRange[0] : yRange[1]);\n  const axisXValue = zeroXInRange ? 0 : (Math.abs(xRange[0]) <= Math.abs(xRange[1]) ? xRange[0] : xRange[1]);\n\n  const axisX1 = worldToScreen(xRange[0], axisYValue);\n  const axisX2 = worldToScreen(xRange[1], axisYValue);\n  const axisY1 = worldToScreen(axisXValue, yRange[0]);\n  const axisY2 = worldToScreen(axisXValue, yRange[1]);\n\n  const gridCfg = typeof grid === 'boolean' ? { stroke: '#999', strokeWidth: 1, opacity: 0.15 } : grid;\n  const minorGridCfgRaw = typeof minorGrid === 'boolean' ? {} : (minorGrid || {});\n  const minorGridCfg = {\n    stroke: minorGridCfgRaw.stroke ?? gridCfg?.stroke ?? '#999',\n    strokeWidth: minorGridCfgRaw.strokeWidth ?? Math.max(0.5, (gridCfg?.strokeWidth ?? 1) * 0.6),\n    opacity: minorGridCfgRaw.opacity ?? Math.min(1, (gridCfg?.opacity ?? 0.15) * 0.9),\n  };\n\n  if ((grid && !minorGrid) && (xSubdivisions === 0 && ySubdivisions === 0)) {\n    xSubdivisions = 4;\n    ySubdivisions = 4;\n    minorGrid = true;\n  }\n\n  const labelYForX = zeroYInRange ? 0 : (Math.abs(yRange[0]) <= Math.abs(yRange[1]) ? yRange[0] : yRange[1]);\n  const labelXForY = zeroXInRange ? 0 : (Math.abs(xRange[0]) <= Math.abs(xRange[1]) ? xRange[0] : xRange[1]);\n\n  const baseXLabelOffset = labelOffset.y ?? 8;\n  const xLabelAbove = zeroYInRange ? false : (labelYForX === yRange[1]);\n\n  const labels = (\n    <foreignObject x={margin.left} y={margin.top} width={innerWidth} height={innerHeight}>\n      <div style={{ position: 'relative', width: '100%', height: '100%', pointerEvents: 'none', fontFamily: 'system-ui, Segoe UI, Roboto, sans-serif', fontSize: 12, color: '#222', userSelect: 'none' }}>\n        {renderXLabel && xTickVals.map((x) => {\n          const node = renderXLabel(x);\n          if (node == null) return null;\n          const p = worldToScreen(x, labelYForX);\n          const topAbs = xLabelAbove ? p.y - baseXLabelOffset : p.y + baseXLabelOffset;\n          const transform = xLabelAbove ? 'translate(-50%, -100%)' : 'translate(-50%, 0)';\n          return (\n            <div key={`xl-${x}`} style={{ position: 'absolute', left: p.x - margin.left, top: topAbs - margin.top, transform, pointerEvents: 'auto' }}>{node}</div>\n          );\n        })}\n        {renderYLabel && yTickVals.map((y) => {\n          const node = renderYLabel(y);\n          if (node == null) return null;\n          const p = worldToScreen(labelXForY, y);\n          const placeLeft = zeroXInRange ? true : (labelXForY === xRange[0]);\n          const baseX = labelOffset.x ?? 12;\n          const leftAbs = p.x + (placeLeft ? -baseX : baseX);\n          const transform = placeLeft ? 'translate(-100%, -50%)' : 'translate(0, -50%)';\n          const textAlign = placeLeft ? 'right' as const : 'left' as const;\n          return (\n            <div key={`yl-${y}`} style={{ position: 'absolute', left: leftAbs - margin.left, top: p.y - margin.top, transform, textAlign, pointerEvents: 'auto' }}>{node}</div>\n          );\n        })}\n      </div>\n    </foreignObject>\n  );\n\n  return (\n    <g clipPath={`url(#${clipPathId})`}>\n      {minorGrid && (xSubdivisions > 0 || ySubdivisions > 0) && (\n        <g stroke={minorGridCfg.stroke} strokeWidth={minorGridCfg.strokeWidth} opacity={minorGridCfg.opacity} shapeRendering=\"crispEdges\" vectorEffect=\"non-scaling-stroke\">\n          {xSubEff > 0 && gridXMajorFinal.length > 1 && gridXMajorFinal.flatMap((xv, i) => {\n            if (i === gridXMajorFinal.length - 1) return [] as React.ReactNode[];\n            const next = gridXMajorFinal[i + 1];\n            const dt = (next - xv) / (xSubEff + 1);\n            const nodes: React.ReactNode[] = [];\n            for (let j = 1; j <= xSubEff; j++) {\n              const x = xv + j * dt;\n              const p1 = worldToScreen(x, yRange[0]);\n              const p2 = worldToScreen(x, yRange[1]);\n              nodes.push(<line key={`gvm-${i}-${j}`} x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} />);\n            }\n            return nodes;\n          })}\n          {ySubEff > 0 && gridYMajorFinal.length > 1 && gridYMajorFinal.flatMap((yv, i) => {\n            if (i === gridYMajorFinal.length - 1) return [] as React.ReactNode[];\n            const next = gridYMajorFinal[i + 1];\n            const dt = (next - yv) / (ySubEff + 1);\n            const nodes: React.ReactNode[] = [];\n            for (let j = 1; j <= ySubEff; j++) {\n              const y = yv + j * dt;\n              const p1 = worldToScreen(xRange[0], y);\n              const p2 = worldToScreen(xRange[1], y);\n              nodes.push(<line key={`ghm-${i}-${j}`} x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} />);\n            }\n            return nodes;\n          })}\n        </g>\n      )}\n      {grid && (\n        <g stroke={gridCfg?.stroke} strokeWidth={gridCfg?.strokeWidth} opacity={gridCfg?.opacity} shapeRendering=\"crispEdges\" vectorEffect=\"non-scaling-stroke\">\n          {zeroYInRange && (() => {\n            const p1 = worldToScreen(xRange[0], 0);\n            const p2 = worldToScreen(xRange[1], 0);\n            return <line key={`gh-0`} x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} />;\n          })()}\n          {zeroXInRange && (() => {\n            const p1 = worldToScreen(0, yRange[0]);\n            const p2 = worldToScreen(0, yRange[1]);\n            return <line key={`gv-0`} x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} />;\n          })()}\n          {gridXMajorFinal.map((x) => {\n            const p1 = worldToScreen(x, yRange[0]);\n            const p2 = worldToScreen(x, yRange[1]);\n            return <line key={`gv-${x}`} x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} />;\n          })}\n          {gridYMajorFinal.map((y) => {\n            const p1 = worldToScreen(xRange[0], y);\n            const p2 = worldToScreen(xRange[1], y);\n            return <line key={`gh-${y}`} x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} />;\n          })}\n        </g>\n      )}\n\n      <g stroke={axisColor} strokeWidth={axisWidth}>\n        <line x1={axisX1.x} y1={axisX1.y} x2={axisX2.x} y2={axisX2.y} />\n        <line x1={axisY1.x} y1={axisY1.y} x2={axisY2.x} y2={axisY2.y} />\n      </g>\n\n      <g stroke={axisColor} strokeWidth={axisWidth}>\n        {xTickVals.map((x) => {\n          const p = worldToScreen(x, axisYValue);\n          const y0 = p.y - tickSize / 2;\n          const y1 = p.y + tickSize / 2;\n          return <line key={`tx-${x}`} x1={p.x} y1={y0} x2={p.x} y2={y1} />;\n        })}\n        {yTickVals.map((y) => {\n          const p = worldToScreen(axisXValue, y);\n          const x0 = p.x - tickSize / 2;\n          const x1 = p.x + tickSize / 2;\n          return <line key={`ty-${y}`} x1={x0} y1={p.y} x2={x1} y2={p.y} />;\n        })}\n      </g>\n\n      {labels}\n    </g>\n  );\n}\n","import React from \"react\";\nimport { usePlot } from \"./context\";\n\nexport type Parametric2DProps = {\n  x: (t: number) => number;\n  y: (t: number) => number;\n  tRange: [number, number];\n  samples?: number;\n  stroke?: string;\n  strokeWidth?: number;\n  strokeDasharray?: string;\n  fill?: string;\n  clip?: boolean;\n  // When true, restrict the effective t-range to what's visible in the current xRange viewport (plus overscan)\n  domainFollowsViewport?: boolean;\n  // If true, we assume x(t) = t so we can map viewport x-range directly to t-range for performance/precision\n  assumeXEqualsT?: boolean;\n  // Fraction of the current viewport width to extend on both sides when domainFollowsViewport is enabled\n  overscan?: number;\n};\n\nexport function Parametric2D({\n  x,\n  y,\n  tRange,\n  samples = 600,\n  stroke = \"#1565c0\",\n  strokeWidth = 2,\n  strokeDasharray,\n  fill = \"none\",\n  clip = true,\n  domainFollowsViewport = false,\n  assumeXEqualsT = false,\n  overscan = 0,\n}: Parametric2DProps) {\n  const { worldToScreen, clipPathId, xRange, yRange } = usePlot();\n\n  // Determine effective t-range based on viewport if requested\n  const [t0Eff, t1Eff, viewportRect] = React.useMemo(() => {\n    let [t0, t1] = tRange;\n    if (!domainFollowsViewport) return [t0, t1] as [number, number];\n    const [xmin, xmax] = xRange;\n    const [ymin, ymax] = yRange;\n    const padX = (xmax - xmin) * overscan;\n    const padY = (ymax - ymin) * overscan;\n    const vx0 = Math.min(xmin, xmax) - padX;\n    const vx1 = Math.max(xmin, xmax) + padX;\n    const vy0 = Math.min(ymin, ymax) - padY;\n    const vy1 = Math.max(ymin, ymax) + padY;\n    if (assumeXEqualsT) {\n      // When x(t) = t, the effective domain is the viewport x-range itself (ignore provided tRange bounds)\n      const nt0 = vx0;\n      const nt1 = vx1;\n      return [nt0, nt1, { vx0, vx1, vy0, vy1 }] as [number, number, { vx0: number; vx1: number; vy0: number; vy1: number }];\n    }\n    // Generic fallback: coarse scan to find t-interval intersecting viewport in x\n    const coarse = 128;\n    let found = false;\n    let tmin = tRange[1];\n    let tmax = tRange[0];\n    for (let i = 0; i <= coarse; i++) {\n      const tt = tRange[0] + (i / coarse) * (tRange[1] - tRange[0]);\n      const xv = x(tt);\n      if (xv >= vx0 && xv <= vx1) {\n        if (!found) { tmin = tt; tmax = tt; found = true; }\n        else { if (tt < tmin) tmin = tt; if (tt > tmax) tmax = tt; }\n      }\n    }\n    if (found) {\n      // Expand slightly to avoid clipping partial segments\n      const expand = (tmax - tmin) * 0.05;\n      t0 = Math.max(tRange[0], tmin - expand);\n      t1 = Math.min(tRange[1], tmax + expand);\n      return [t0, t1, { vx0, vx1, vy0, vy1 }] as [number, number, { vx0: number; vx1: number; vy0: number; vy1: number }];\n    }\n    // If nothing found, choose closest end by x-distance\n    const x0 = x(tRange[0]);\n    const x1 = x(tRange[1]);\n    const d0 = Math.min(Math.abs(x0 - vx0), Math.abs(x0 - vx1));\n    const d1 = Math.min(Math.abs(x1 - vx0), Math.abs(x1 - vx1));\n    const tt0 = d0 <= d1 ? tRange[0] : tRange[1];\n    const rect = { vx0, vx1, vy0, vy1 };\n    return [tt0, tt0, rect] as [number, number, { vx0: number; vx1: number; vy0: number; vy1: number }];\n  }, [tRange[0], tRange[1], domainFollowsViewport, assumeXEqualsT, xRange[0], xRange[1], yRange[0], yRange[1], overscan, x]);\n\n  const n = Math.max(2, Math.floor(samples));\n  const dt = (t1Eff - t0Eff) / (n - 1 || 1);\n\n  const d = React.useMemo(() => {\n    // Build path with sub-segments only where curve is within the padded viewport rectangle\n    const { vx0, vx1, vy0, vy1 } = viewportRect || { vx0: -Infinity, vx1: Infinity, vy0: -Infinity, vy1: Infinity } as any;\n    let path = \"\";\n    let hasOpen = false;\n    for (let i = 0; i < (n || 2); i++) {\n      const t = t0Eff + i * dt;\n      const wx = x(t);\n      const wy = y(t);\n      const inside = wx >= vx0 && wx <= vx1 && wy >= vy0 && wy <= vy1;\n      const sp = worldToScreen(wx, wy);\n      if (inside) {\n        if (!hasOpen) {\n          path += (path ? ' ' : '') + 'M ' + sp.x + ' ' + sp.y;\n          hasOpen = true;\n        } else {\n          path += ' L ' + sp.x + ' ' + sp.y;\n        }\n      } else {\n        hasOpen = false;\n      }\n    }\n    return path;\n  }, [x, y, t0Eff, t1Eff, n, dt, worldToScreen, viewportRect]);\n\n  return (\n    <path\n      d={d}\n      stroke={stroke}\n      strokeWidth={strokeWidth}\n      strokeDasharray={strokeDasharray}\n      fill={fill}\n      clipPath={clip ? `url(#${clipPathId})` : undefined}\n    />\n  );\n}\n","import React from \"react\";\nimport { usePlot } from \"./context\";\n\nexport type Polygon2DProps = {\n  points: Array<[number, number]>;\n  stroke?: string;\n  strokeWidth?: number;\n  fill?: string;\n  closed?: boolean;\n  clip?: boolean;\n};\n\nexport function Polygon2D({\n  points,\n  stroke = \"#000\",\n  strokeWidth = 2,\n  fill = \"rgba(0,0,0,0.06)\",\n  closed = true,\n  clip = true,\n}: Polygon2DProps) {\n  const { worldToScreen, clipPathId } = usePlot();\n  const d = React.useMemo(() => {\n    if (!points.length) return \"\";\n    const [x0, y0] = points[0];\n    const p0 = worldToScreen(x0, y0);\n    let s = 'M ' + p0.x + ' ' + p0.y;\n    for (let i = 1; i < points.length; i++) {\n      const [x, y] = points[i];\n      const p = worldToScreen(x, y);\n      s += ' L ' + p.x + ' ' + p.y;\n    }\n    if (closed) s += ' Z';\n    return s;\n  }, [points, worldToScreen, closed]);\n\n  return (\n    <path\n      d={d}\n      stroke={stroke}\n      strokeWidth={strokeWidth}\n      fill={closed ? fill : \"none\"}\n      clipPath={clip ? `url(#${clipPathId})` : undefined}\n    />\n  );\n}\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type ArcProps = {\r\n  cx: number;\r\n  cy: number;\r\n  r: number; // radius in world units\r\n  a0: number; // start angle (radians)\r\n  a1: number; // end angle (radians)\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  fill?: string; // if provided, draws a wedge (sector) fill\r\n  fillOpacity?: number;\r\n  clip?: boolean;\r\n};\r\n\r\nfunction polar(cx: number, cy: number, r: number, a: number) {\r\n  return { x: cx + r * Math.cos(a), y: cy + r * Math.sin(a) };\r\n}\r\n\r\nfunction arcPath(cx: number, cy: number, r: number, a0: number, a1: number, asWedge: boolean) {\r\n  // Normalize angles\r\n  let start = a0;\r\n  let end = a1;\r\n  const twoPi = Math.PI * 2;\r\n  // Reduce span to at most 2π for SVG arc flags\r\n  let da = end - start;\r\n  // If angles are equal, draw nothing\r\n  if (Math.abs(da) < 1e-12) return \"\";\r\n  // Normalize to positive sweep direction and track sweep flag\r\n  const sweep = da >= 0 ? 1 : 0; // 1 means positive-angle direction (clockwise in SVG y-down, but our mapping handles orientation)\r\n  da = Math.abs(da);\r\n  if (da > twoPi) da = twoPi;\r\n  // Adjust end from start by da in the chosen sweep direction\r\n  end = sweep ? (start + da) : (start - da);\r\n\r\n  const p0 = polar(cx, cy, r, start);\r\n  const p1 = polar(cx, cy, r, end);\r\n  const largeArc = da > Math.PI ? 1 : 0;\r\n  // Path in world coords; will be transformed via worldToScreen per point before rendering\r\n  if (asWedge) {\r\n    return `W ${cx} ${cy} ${p0.x} ${p0.y} ${r} ${largeArc} ${sweep} ${p1.x} ${p1.y}`; // custom token we'll expand\r\n  } else {\r\n    return `A ${p0.x} ${p0.y} ${r} ${largeArc} ${sweep} ${p1.x} ${p1.y}`; // custom token we'll expand\r\n  }\r\n}\r\n\r\nexport function Arc({ cx, cy, r, a0, a1, stroke = \"#333\", strokeWidth = 1.5, fill, fillOpacity = 0.2, clip = true }: ArcProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n\r\n  const d = React.useMemo(() => {\r\n    // Sample the arc in world space (circle centered at (cx,cy)) and map to a\r\n    // screen-space polyline. This preserves the correct ellipse (rx != ry) and\r\n    // keeps the arc centered at world (cx,cy) after non-uniform scaling.\r\n    let da = a1 - a0;\r\n    if (Math.abs(da) < 1e-12 || !isFinite(r) || r <= 0) return \"\";\r\n    const twoPi = Math.PI * 2;\r\n    const sweepSign = da >= 0 ? 1 : -1;\r\n    da = Math.min(twoPi, Math.abs(da));\r\n    const span = da;\r\n    // ~64 segments for full circle (enough for smooth visuals)\r\n    const segments = Math.max(6, Math.ceil(span / (Math.PI / 64)));\r\n    const step = sweepSign * (span / segments);\r\n    const points: {x:number;y:number}[] = [];\r\n    for (let i = 0; i <= segments; i++) {\r\n      const t = a0 + i * step;\r\n      const wx = cx + r * Math.cos(t);\r\n      const wy = cy + r * Math.sin(t);\r\n      points.push(worldToScreen(wx, wy));\r\n    }\r\n    if (!points.length) return \"\";\r\n    if (fill) {\r\n      const c = worldToScreen(cx, cy);\r\n      let s = `M ${c.x} ${c.y} L ${points[0].x} ${points[0].y}`;\r\n      for (let i = 1; i < points.length; i++) s += ` L ${points[i].x} ${points[i].y}`;\r\n      s += \" Z\";\r\n      return s;\r\n    } else {\r\n      let s = `M ${points[0].x} ${points[0].y}`;\r\n      for (let i = 1; i < points.length; i++) s += ` L ${points[i].x} ${points[i].y}`;\r\n      return s;\r\n    }\r\n  }, [cx, cy, r, a0, a1, worldToScreen, fill]);\r\n\r\n  if (!d) return null;\r\n\r\n  return (\r\n    <path\r\n      d={d}\r\n      stroke={stroke}\r\n      strokeWidth={strokeWidth}\r\n      fill={fill ? fill : \"none\"}\r\n      fillOpacity={fill ? fillOpacity : undefined}\r\n      clipPath={clip ? `url(#${clipPathId})` : undefined}\r\n    />\r\n  );\r\n}\r\n\r\nexport type CircleProps = {\r\n  cx: number;\r\n  cy: number;\r\n  r: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  fill?: string;\r\n  fillOpacity?: number;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function Circle({ cx, cy, r, stroke = \"#333\", strokeWidth = 1, fill = \"none\", fillOpacity = 1, clip = true }: CircleProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const c = worldToScreen(cx, cy);\r\n  const rx = Math.abs(r * (worldToScreen(cx + 1, cy).x - c.x));\r\n  const ry = Math.abs(r * (worldToScreen(cx, cy + 1).y - c.y));\r\n  return (\r\n    <g clipPath={clip ? `url(#${clipPathId})` : undefined}>\r\n      <ellipse cx={c.x} cy={c.y} rx={rx} ry={ry} fill={fill} fillOpacity={fill !== \"none\" ? fillOpacity : undefined} />\r\n      <ellipse cx={c.x} cy={c.y} rx={rx} ry={ry} fill=\"none\" stroke={stroke} strokeWidth={strokeWidth} />\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type LabelProps = {\r\n  x: number;\r\n  y: number;\r\n  children: React.ReactNode;\r\n  align?: \"center\" | \"left\" | \"right\";\r\n  vAlign?: \"middle\" | \"top\" | \"bottom\";\r\n  dx?: number; // pixel offset x\r\n  dy?: number; // pixel offset y\r\n  pointerEvents?: \"auto\" | \"none\";\r\n  width?: string | number;\r\n  height?: string | number;\r\n};\r\n\r\nexport function Label({ x, y, children, align = \"center\", vAlign = \"middle\", dx = 0, dy = 0, pointerEvents = \"auto\", width, height }: LabelProps) {\r\n  const { worldToScreen, margin, innerWidth, innerHeight } = usePlot();\r\n  const p = worldToScreen(x, y);\r\n\r\n  const transformX = align === \"center\" ? \"-50%\" : (align === \"right\" ? \"-100%\" : \"0\");\r\n  const transformY = vAlign === \"middle\" ? \"-50%\" : (vAlign === \"bottom\" ? \"-100%\" : \"0\");\r\n\r\n  // Place a foreignObject covering the plotting area; position child absolutely inside it\r\n  const left = p.x - margin.left + dx;\r\n  const top = p.y - margin.top + dy;\r\n\r\n  return (\r\n    <foreignObject x={margin.left} y={margin.top} width={innerWidth} height={innerHeight}>\r\n      <div style={{ position: \"relative\", width: width || \"100%\", height: height || \"100%\", pointerEvents: \"none\", fontFamily: \"system-ui, Segoe UI, Roboto, sans-serif\", fontSize: 12, color: \"#222\" }}>\r\n        <div style={{ position: \"absolute\", left, top, transform: `translate(${transformX}, ${transformY})`, pointerEvents }}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </foreignObject>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type LineProps = {\r\n  x1: number;\r\n  y1: number;\r\n  x2: number;\r\n  y2: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function Line({\r\n  x1,\r\n  y1,\r\n  x2,\r\n  y2,\r\n  stroke = \"#1565c0\",\r\n  strokeWidth = 2,\r\n  strokeDasharray,\r\n  clip = true,\r\n}: LineProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const p1 = worldToScreen(x1, y1);\r\n  const p2 = worldToScreen(x2, y2);\r\n  return (\r\n    <line\r\n      x1={p1.x}\r\n      y1={p1.y}\r\n      x2={p2.x}\r\n      y2={p2.y}\r\n      stroke={stroke}\r\n      strokeWidth={strokeWidth}\r\n      strokeDasharray={strokeDasharray}\r\n      clipPath={clip ? `url(#${clipPathId})` : undefined}\r\n    />\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Parametric2D } from \"./Parametric2D\";\r\n\r\nexport type Function2DProps = {\r\n  f: (x: number) => number;\r\n  xRange: [number, number];\r\n  samples?: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  clip?: boolean;\r\n  domainFollowsViewport?: boolean;\r\n  overscan?: number;\r\n};\r\n\r\nexport function Function2D({\r\n  f,\r\n  xRange,\r\n  samples = 600,\r\n  stroke = \"#1565c0\",\r\n  strokeWidth = 2,\r\n  strokeDasharray,\r\n  clip = true,\r\n  domainFollowsViewport = true,\r\n  overscan = 0,\r\n}: Function2DProps) {\r\n  return (\r\n    <Parametric2D\r\n      x={(t: number) => t}\r\n      y={(t: number) => f(t)}\r\n      tRange={xRange}\r\n      samples={samples}\r\n      stroke={stroke}\r\n      strokeWidth={strokeWidth}\r\n      strokeDasharray={strokeDasharray}\r\n      clip={clip}\r\n      domainFollowsViewport={domainFollowsViewport}\r\n      assumeXEqualsT={true}\r\n      overscan={overscan}\r\n    />\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Point2DProps = {\r\n  x: number;\r\n  y: number;\r\n  r?: number; // radius in pixels\r\n  fill?: string;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function Point2D({ x, y, r = 3, fill = \"#1565c0\", stroke = \"none\", strokeWidth = 1, clip = true }: Point2DProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const p = worldToScreen(x, y);\r\n  return (\r\n    <g clipPath={clip ? `url(#${clipPathId})` : undefined}>\r\n      <circle cx={p.x} cy={p.y} r={r} fill={fill} stroke={stroke} strokeWidth={strokeWidth} />\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Scatter2DProps = {\r\n  points: Array<[number, number] | { x: number; y: number }>;\r\n  r?: number; // radius in pixels (used for default marker)\r\n  fill?: string;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  clip?: boolean;\r\n  // Optional custom renderer for each point. Returned node will be wrapped in a <g transform=\"translate(sx,sy)\">\r\n  renderPoint?: (args: { x: number; y: number; i: number; sx: number; sy: number }) => React.ReactNode;\r\n};\r\n\r\nexport function Scatter2D({ points, r = 2.5, fill = \"#1565c0\", stroke = \"none\", strokeWidth = 1, clip = true, renderPoint }: Scatter2DProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const nodes = React.useMemo(() => {\r\n    return points.map((pt, i) => {\r\n      const x = Array.isArray(pt) ? pt[0] : pt.x;\r\n      const y = Array.isArray(pt) ? pt[1] : pt.y;\r\n      const p = worldToScreen(x, y);\r\n      if (renderPoint) {\r\n        return (\r\n          <g key={i} transform={`translate(${p.x},${p.y})`}>\r\n            {renderPoint({ x, y, i, sx: p.x, sy: p.y })}\r\n          </g>\r\n        );\r\n      }\r\n      return <circle key={i} cx={p.x} cy={p.y} r={r} fill={fill} stroke={stroke} strokeWidth={strokeWidth} />;\r\n    });\r\n  }, [points, worldToScreen, r, fill, stroke, strokeWidth, renderPoint]);\r\n  return <g clipPath={clip ? `url(#${clipPathId})` : undefined}>{nodes}</g>;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\nimport { Line } from \"./Line\";\r\n\r\nexport type Ray2DProps = {\r\n  from: [number, number];\r\n  through: [number, number];\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  clip?: boolean; // Line itself is clipped; this prop kept for API similarity\r\n};\r\n\r\nexport function Ray2D({ from, through, stroke = \"#1565c0\", strokeWidth = 2, strokeDasharray }: Ray2DProps) {\r\n  const { xRange, yRange } = usePlot();\r\n  const [x0, y0] = from;\r\n  const [x1, y1] = through;\r\n  const dx = x1 - x0;\r\n  const dy = y1 - y0;\r\n  const eps = 1e-12;\r\n  const candidates: Array<[number, number]> = [];\r\n  // Parametric p(t) = (x0,y0) + t*(dx,dy), t>=0; intersect with bbox lines\r\n  const addIfValid = (t: number) => {\r\n    if (t >= 0 && isFinite(t)) candidates.push([x0 + t * dx, y0 + t * dy]);\r\n  };\r\n  // x = xmin\r\n  if (Math.abs(dx) > eps) addIfValid((xRange[0] - x0) / dx);\r\n  // x = xmax\r\n  if (Math.abs(dx) > eps) addIfValid((xRange[1] - x0) / dx);\r\n  // y = ymin\r\n  if (Math.abs(dy) > eps) addIfValid((yRange[0] - y0) / dy);\r\n  // y = ymax\r\n  if (Math.abs(dy) > eps) addIfValid((yRange[1] - y0) / dy);\r\n  // Choose the farthest valid point along the ray inside the bbox\r\n  let end: [number, number] = [x0, y0];\r\n  let bestT = -Infinity;\r\n  for (const [xe, ye] of candidates) {\r\n    // Check inside bbox with tolerance\r\n    const inside = xe >= Math.min(xRange[0], xRange[1]) - eps && xe <= Math.max(xRange[0], xRange[1]) + eps &&\r\n      ye >= Math.min(yRange[0], yRange[1]) - eps && ye <= Math.max(yRange[0], yRange[1]) + eps;\r\n    if (!inside) continue;\r\n    const t = Math.abs(dx) > Math.abs(dy) ? (xe - x0) / (dx || 1) : (ye - y0) / (dy || 1);\r\n    if (t >= 0 && t > bestT) { bestT = t; end = [xe, ye]; }\r\n  }\r\n  return <Line x1={x0} y1={y0} x2={end[0]} y2={end[1]} stroke={stroke} strokeWidth={strokeWidth} strokeDasharray={strokeDasharray} />;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Vector2DProps = {\r\n  x1: number;\r\n  y1: number;\r\n  x2: number;\r\n  y2: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  headSize?: number; // in pixels\r\n  fillHead?: string;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function Vector2D({ x1, y1, x2, y2, stroke = \"#1565c0\", strokeWidth = 2, headSize = 8, fillHead, clip = true }: Vector2DProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const p1 = worldToScreen(x1, y1);\r\n  const p2 = worldToScreen(x2, y2);\r\n  const dx = p2.x - p1.x;\r\n  const dy = p2.y - p1.y;\r\n  const len = Math.hypot(dx, dy) || 1;\r\n  const ux = dx / len;\r\n  const uy = dy / len;\r\n  const hs = Math.max(2, headSize);\r\n  const backX = p2.x - ux * hs;\r\n  const backY = p2.y - uy * hs;\r\n  const orthoX = -uy;\r\n  const orthoY = ux;\r\n  const w = hs * 0.6;\r\n  const a = { x: p2.x, y: p2.y };\r\n  const b = { x: backX + orthoX * w * 0.5, y: backY + orthoY * w * 0.5 };\r\n  const c = { x: backX - orthoX * w * 0.5, y: backY - orthoY * w * 0.5 };\r\n  return (\r\n    <g clipPath={clip ? `url(#${clipPathId})` : undefined}>\r\n      <line x1={p1.x} y1={p1.y} x2={backX} y2={backY} stroke={stroke} strokeWidth={strokeWidth} />\r\n      <polygon points={`${a.x},${a.y} ${b.x},${b.y} ${c.x},${c.y}`} fill={fillHead ?? stroke} />\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Polyline2DProps = {\r\n  points: Array<[number, number]>;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function Polyline2D({ points, stroke = \"#1565c0\", strokeWidth = 2, strokeDasharray, clip = true }: Polyline2DProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const d = React.useMemo(() => {\r\n    if (!points.length) return \"\";\r\n    const [x0, y0] = points[0];\r\n    const p0 = worldToScreen(x0, y0);\r\n    let s = `M ${p0.x} ${p0.y}`;\r\n    for (let i = 1; i < points.length; i++) {\r\n      const [x, y] = points[i];\r\n      const p = worldToScreen(x, y);\r\n      s += ` L ${p.x} ${p.y}`;\r\n    }\r\n    return s;\r\n  }, [points, worldToScreen]);\r\n  return <path d={d} stroke={stroke} strokeWidth={strokeWidth} strokeDasharray={strokeDasharray} fill=\"none\" clipPath={clip ? `url(#${clipPathId})` : undefined} />;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Bezier2DProps =\r\n  | { kind: \"quadratic\"; p0: [number, number]; p1: [number, number]; p2: [number, number]; samples?: number; stroke?: string; strokeWidth?: number; strokeDasharray?: string; clip?: boolean }\r\n  | { kind: \"cubic\"; p0: [number, number]; p1: [number, number]; p2: [number, number]; p3: [number, number]; samples?: number; stroke?: string; strokeWidth?: number; strokeDasharray?: string; clip?: boolean };\r\n\r\nexport function Bezier2D(props: Bezier2DProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const samples = props.samples ?? 120;\r\n  const stroke = (props as any).stroke ?? \"#1565c0\";\r\n  const strokeWidth = (props as any).strokeWidth ?? 2;\r\n  const strokeDasharray = (props as any).strokeDasharray as string | undefined;\r\n  const clip = (props as any).clip ?? true;\r\n\r\n  const points = React.useMemo(() => {\r\n    const pts: Array<{ x: number; y: number }> = [];\r\n    if (props.kind === \"quadratic\") {\r\n      const [x0, y0] = props.p0;\r\n      const [x1, y1] = props.p1;\r\n      const [x2, y2] = props.p2;\r\n      for (let i = 0; i <= samples; i++) {\r\n        const t = i / samples;\r\n        const u = 1 - t;\r\n        const wx = u * u * x0 + 2 * u * t * x1 + t * t * x2;\r\n        const wy = u * u * y0 + 2 * u * t * y1 + t * t * y2;\r\n        pts.push(worldToScreen(wx, wy));\r\n      }\r\n    } else {\r\n      const [x0, y0] = props.p0;\r\n      const [x1, y1] = props.p1;\r\n      const [x2, y2] = props.p2;\r\n      const [x3, y3] = (props as any).p3 as [number, number];\r\n      for (let i = 0; i <= samples; i++) {\r\n        const t = i / samples;\r\n        const u = 1 - t;\r\n        const wx = u * u * u * x0 + 3 * u * u * t * x1 + 3 * u * t * t * x2 + t * t * t * x3;\r\n        const wy = u * u * u * y0 + 3 * u * u * t * y1 + 3 * u * t * t * y2 + t * t * t * y3;\r\n        pts.push(worldToScreen(wx, wy));\r\n      }\r\n    }\r\n    return pts;\r\n  }, [(props as any).p0?.[0], (props as any).p0?.[1], (props as any).p1?.[0], (props as any).p1?.[1], (props as any).p2?.[0], (props as any).p2?.[1], (props as any).kind, (props as any).p3?.[0], (props as any).p3?.[1], samples, worldToScreen]);\r\n\r\n  const d = React.useMemo(() => {\r\n    if (points.length === 0) return \"\";\r\n    const [p0, ...rest] = points;\r\n    return 'M ' + p0.x + ' ' + p0.y + ' ' + rest.map(p => 'L ' + p.x + ' ' + p.y).join(' ');\r\n  }, [points]);\r\n\r\n  return <path d={d} stroke={stroke} strokeWidth={strokeWidth} strokeDasharray={strokeDasharray} fill=\"none\" clipPath={clip ? `url(#${clipPathId})` : undefined} />;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Area2DProps = {\r\n  f: (x: number) => number;\r\n  a: number;\r\n  b: number;\r\n  baseline?: number | ((x: number) => number);\r\n  samples?: number;\r\n  fill?: string;\r\n  fillOpacity?: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function Area2D({ f, a, b, baseline = 0, samples = 300, fill = \"rgba(21,101,192,0.15)\", fillOpacity, stroke = \"#1565c0\", strokeWidth = 1, clip = true }: Area2DProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const d = React.useMemo(() => {\r\n    const n = Math.max(2, Math.floor(samples));\r\n    const x0 = Math.min(a, b);\r\n    const x1 = Math.max(a, b);\r\n    const ptsTop: Array<{ x: number; y: number }> = [];\r\n    for (let i = 0; i <= n; i++) {\r\n      const t = i / n;\r\n      const x = x0 + t * (x1 - x0);\r\n      ptsTop.push(worldToScreen(x, f(x)));\r\n    }\r\n    const ptsBase: Array<{ x: number; y: number }> = [];\r\n    for (let i = n; i >= 0; i--) {\r\n      const t = i / n;\r\n      const x = x0 + t * (x1 - x0);\r\n      const yb = typeof baseline === 'number' ? baseline : baseline(x);\r\n      ptsBase.push(worldToScreen(x, yb));\r\n    }\r\n    if (ptsTop.length === 0) return \"\";\r\n    const start = ptsTop[0];\r\n    let s = `M ${start.x} ${start.y}`;\r\n    for (let i = 1; i < ptsTop.length; i++) s += ` L ${ptsTop[i].x} ${ptsTop[i].y}`;\r\n    for (let i = 0; i < ptsBase.length; i++) s += ` L ${ptsBase[i].x} ${ptsBase[i].y}`;\r\n    s += \" Z\";\r\n    return s;\r\n  }, [a, b, samples, baseline, f, worldToScreen]);\r\n\r\n  return (\r\n    <path d={d} fill={fill} fillOpacity={fillOpacity} stroke={stroke} strokeWidth={strokeWidth} clipPath={clip ? `url(#${clipPathId})` : undefined} />\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type RiemannSumMethod = \"left\" | \"right\" | \"mid\" | \"trapezoid\";\r\n\r\nexport type RiemannSumProps = {\r\n  f: (x: number) => number;\r\n  a: number;\r\n  b: number;\r\n  n: number;\r\n  method?: RiemannSumMethod;\r\n  baseline?: number; // for drawing rectangles down to this y (default 0)\r\n  fill?: string;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  clip?: boolean;\r\n};\r\n\r\nexport function RiemannSum({ f, a, b, n, method = \"mid\", baseline = 0, fill = \"rgba(21,101,192,0.15)\", stroke = \"#1565c0\", strokeWidth = 1, clip = true }: RiemannSumProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const rects = React.useMemo(() => {\r\n    const rects: Array<string> = [];\r\n    const x0 = Math.min(a, b);\r\n    const x1 = Math.max(a, b);\r\n    const dx = (x1 - x0) / Math.max(1, n);\r\n    for (let i = 0; i < n; i++) {\r\n      let xLeft = x0 + i * dx;\r\n      let xRight = xLeft + dx;\r\n      let heightY: number;\r\n      if (method === \"left\") heightY = f(xLeft);\r\n      else if (method === \"right\") heightY = f(xRight);\r\n      else if (method === \"mid\") heightY = f((xLeft + xRight) * 0.5);\r\n      else /* trapezoid */ heightY = (f(xLeft) + f(xRight)) * 0.5;\r\n\r\n      const yTop = method === \"trapezoid\" ? undefined : heightY;\r\n      if (method === \"trapezoid\") {\r\n        const p1 = worldToScreen(xLeft, baseline);\r\n        const p2 = worldToScreen(xLeft, f(xLeft));\r\n        const p3 = worldToScreen(xRight, f(xRight));\r\n        const p4 = worldToScreen(xRight, baseline);\r\n        rects.push(`M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} L ${p3.x} ${p3.y} L ${p4.x} ${p4.y} Z`);\r\n      } else {\r\n        const p1 = worldToScreen(xLeft, baseline);\r\n        const p2 = worldToScreen(xLeft, yTop as number);\r\n        const p3 = worldToScreen(xRight, yTop as number);\r\n        const p4 = worldToScreen(xRight, baseline);\r\n        rects.push(`M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} L ${p3.x} ${p3.y} L ${p4.x} ${p4.y} Z`);\r\n      }\r\n    }\r\n    return rects;\r\n  }, [a, b, n, method, baseline, f, worldToScreen]);\r\n\r\n  return (\r\n    <g clipPath={clip ? `url(#${clipPathId})` : undefined}>\r\n      {rects.map((d, i) => (\r\n        <path key={i} d={d} fill={fill} stroke={stroke} strokeWidth={strokeWidth} />\r\n      ))}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\nimport { Line } from \"./Line\";\r\n\r\nexport type TangentLineProps = {\r\n  f: (x: number) => number;\r\n  x0: number;\r\n  color?: string;\r\n  strokeWidth?: number;\r\n};\r\n\r\nexport function TangentLine({ f, x0, color = \"#ef4444\", strokeWidth = 1.5 }: TangentLineProps) {\r\n  const { xRange } = usePlot();\r\n  const span = Math.max(1e-8, Math.abs(xRange[1] - xRange[0]));\r\n  const h = span * 1e-8;\r\n  const y0 = f(x0);\r\n  const dydx = (f(x0 + h) - f(x0 - h)) / (2 * h);\r\n  const xA = xRange[0];\r\n  const xB = xRange[1];\r\n  const yA = y0 + dydx * (xA - x0);\r\n  const yB = y0 + dydx * (xB - x0);\r\n  return <Line x1={xA} y1={yA} x2={xB} y2={yB} stroke={color} strokeWidth={strokeWidth} />;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\nimport { Line } from \"./Line\";\r\n\r\nexport type NormalLineProps = {\r\n  f: (x: number) => number;\r\n  x0: number;\r\n  color?: string;\r\n  strokeWidth?: number;\r\n};\r\n\r\nexport function NormalLine({ f, x0, color = \"#10b981\", strokeWidth = 1.5 }: NormalLineProps) {\r\n  const { xRange, yRange, innerWidth, innerHeight } = usePlot();\r\n  const span = Math.max(1e-8, Math.abs(xRange[1] - xRange[0]));\r\n  const h = span * 1e-8;\r\n  const y0 = f(x0);\r\n  const dydx = (f(x0 + h) - f(x0 - h)) / (2 * h);\r\n\r\n  // Compute a world-space direction vector for the normal that is perpendicular in screen space,\r\n  // accounting for anisotropic scaling between X and Y.\r\n  const scaleX = Math.abs(innerWidth / (xRange[1] - xRange[0]));\r\n  const scaleY = Math.abs(innerHeight / (yRange[1] - yRange[0]));\r\n  let vx = -(scaleY / Math.max(1e-12, scaleX)) * dydx;\r\n  let vy = (scaleX / Math.max(1e-12, scaleY));\r\n  if (!isFinite(dydx)) { vx = 0; vy = 1; }\r\n  if (Math.abs(vx) + Math.abs(vy) < 1e-16) { vx = 0; vy = 1; }\r\n\r\n  // Intersect the infinite line p(t) = (x0,y0) + t*(vx,vy) with the viewport bbox\r\n  const xmin = Math.min(xRange[0], xRange[1]);\r\n  const xmax = Math.max(xRange[0], xRange[1]);\r\n  const ymin = Math.min(yRange[0], yRange[1]);\r\n  const ymax = Math.max(yRange[0], yRange[1]);\r\n  const eps = 1e-12;\r\n  const ts: number[] = [];\r\n  if (Math.abs(vx) > eps) { ts.push((xmin - x0) / vx, (xmax - x0) / vx); }\r\n  if (Math.abs(vy) > eps) { ts.push((ymin - y0) / vy, (ymax - y0) / vy); }\r\n\r\n  const pts: Array<[number, number, number]> = [];\r\n  for (const t of ts) {\r\n    const x = x0 + vx * t;\r\n    const y = y0 + vy * t;\r\n    if (x >= xmin - 1e-9 && x <= xmax + 1e-9 && y >= ymin - 1e-9 && y <= ymax + 1e-9) {\r\n      pts.push([x, y, t]);\r\n    }\r\n  }\r\n  pts.sort((a, b) => a[2] - b[2]);\r\n\r\n  let xA = x0, yA = y0, xB = x0, yB = y0;\r\n  if (pts.length >= 2) {\r\n    [xA, yA] = [pts[0][0], pts[0][1]];\r\n    [xB, yB] = [pts[pts.length - 1][0], pts[pts.length - 1][1]];\r\n  } else if (pts.length === 1) {\r\n    const [xe, ye] = pts[0];\r\n    const ext = Math.max(xmax - xmin, ymax - ymin) || 1;\r\n    xA = xe - vx * ext; yA = ye - vy * ext;\r\n    xB = xe + vx * ext; yB = ye + vy * ext;\r\n  } else {\r\n    // Fallback: vertical through point (should be rare)\r\n    xA = x0; yA = ymin; xB = x0; yB = ymax;\r\n  }\r\n\r\n  return <Line x1={xA} y1={yA} x2={xB} y2={yB} stroke={color} strokeWidth={strokeWidth} />;\r\n}\r\n","import React from \"react\";\r\nimport { Arc } from \"./Arc\";\r\n\r\nexport type AngleMarkerProps = {\r\n  center: [number, number];\r\n  a: [number, number];\r\n  b: [number, number];\r\n  r?: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  fill?: string;\r\n  fillOpacity?: number;\r\n};\r\n\r\nexport function AngleMarker({ center, a, b, r = 0.3, stroke = \"#ef4444\", strokeWidth = 2, fill, fillOpacity = 0.15 }: AngleMarkerProps) {\r\n  const [cx, cy] = center;\r\n  const ang = (p: [number, number]) => Math.atan2(p[1] - cy, p[0] - cx);\r\n  let a0 = ang(a);\r\n  let a1 = ang(b);\r\n  // Normalize to shortest positive sweep from a0 to a1\r\n  let da = a1 - a0;\r\n  while (da <= -Math.PI) { a1 += 2 * Math.PI; da = a1 - a0; }\r\n  while (da > Math.PI) { a1 -= 2 * Math.PI; da = a1 - a0; }\r\n  return <Arc cx={cx} cy={cy} r={r} a0={a0} a1={a1} stroke={stroke} strokeWidth={strokeWidth} fill={fill} fillOpacity={fill ? fillOpacity : undefined as any} />;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type DistanceMarkerProps = {\r\n  x1: number; y1: number; x2: number; y2: number;\r\n  tickSize?: number; // in pixels, length of end ticks\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  label?: React.ReactNode;\r\n  labelOffsetPx?: number; // shift label away from segment (perpendicular) in px\r\n  clip?: boolean;\r\n};\r\n\r\nexport function DistanceMarker({ x1, y1, x2, y2, tickSize = 8, stroke = \"#333\", strokeWidth = 1, label, labelOffsetPx = 10, clip = true }: DistanceMarkerProps) {\r\n  const { worldToScreen, clipPathId } = usePlot();\r\n  const p1 = worldToScreen(x1, y1);\r\n  const p2 = worldToScreen(x2, y2);\r\n  const dx = p2.x - p1.x;\r\n  const dy = p2.y - p1.y;\r\n  const len = Math.hypot(dx, dy) || 1;\r\n  const ux = dx / len;\r\n  const uy = dy / len;\r\n  const ox = -uy;\r\n  const oy = ux;\r\n  const t = tickSize * 0.5;\r\n  const t1a = { x: p1.x + ox * t, y: p1.y + oy * t };\r\n  const t1b = { x: p1.x - ox * t, y: p1.y - oy * t };\r\n  const t2a = { x: p2.x + ox * t, y: p2.y + oy * t };\r\n  const t2b = { x: p2.x - ox * t, y: p2.y - oy * t };\r\n  const mid = { x: (p1.x + p2.x) / 2 + ox * labelOffsetPx, y: (p1.y + p2.y) / 2 + oy * labelOffsetPx };\r\n  return (\r\n    <g clipPath={clip ? `url(#${clipPathId})` : undefined}>\r\n      <line x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} stroke={stroke} strokeWidth={strokeWidth} />\r\n      <line x1={t1a.x} y1={t1a.y} x2={t1b.x} y2={t1b.y} stroke={stroke} strokeWidth={strokeWidth} />\r\n      <line x1={t2a.x} y1={t2a.y} x2={t2b.x} y2={t2b.y} stroke={stroke} strokeWidth={strokeWidth} />\r\n      {label && (\r\n        <foreignObject x={Math.min(p1.x, p2.x)} y={Math.min(p1.y, p2.y)} width={Math.abs(p2.x - p1.x) || 1} height={Math.abs(p2.y - p1.y) || 1}>\r\n          <div style={{ position: 'relative', width: '100%', height: '100%', pointerEvents: 'none', fontFamily: 'system-ui, Segoe UI, Roboto, sans-serif', fontSize: 12, color: '#222' }}>\r\n            <div style={{ position: 'absolute', left: mid.x - Math.min(p1.x, p2.x), top: mid.y - Math.min(p1.y, p2.y), transform: 'translate(-50%, -50%)' }}>{label}</div>\r\n          </div>\r\n        </foreignObject>\r\n      )}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\nimport { Vector2D } from \"./Vector2D\";\r\n\r\nexport type VectorField2DProps = {\r\n  v: (x: number, y: number) => { vx: number; vy: number } | [number, number];\r\n  // Sampling layout\r\n  mode?: \"world\" | \"viewport\"; // world: grid sticks to world coords. viewport: grid tied to viewport lattice.\r\n  origin?: [number, number]; // for mode=\"world\" grid alignment (default [0,0])\r\n  stepX?: number; // world step size in X for mode=\"world\"\r\n  stepY?: number; // world step size in Y for mode=\"world\"\r\n  countX?: number; // used for mode=\"viewport\" or initial step estimation\r\n  countY?: number; // used for mode=\"viewport\" or initial step estimation\r\n  // Arrow styling\r\n  normalize?: boolean; // if true, arrows have same length (scaled)\r\n  scale?: number; // world length when normalize=true; multiplier otherwise\r\n  color?: string;\r\n  strokeWidth?: number;\r\n  headSize?: number; // px\r\n  clip?: boolean;\r\n};\r\n\r\nexport function VectorField2D({\r\n  v,\r\n  mode = \"world\",\r\n  origin = [0, 0],\r\n  stepX,\r\n  stepY,\r\n  countX = 16,\r\n  countY = 12,\r\n  normalize = true,\r\n  scale,\r\n  color = \"#334155\",\r\n  strokeWidth = 1.5,\r\n  headSize = 8,\r\n}: VectorField2DProps) {\r\n  const { xRange, yRange } = usePlot();\r\n  const xmin = Math.min(xRange[0], xRange[1]);\r\n  const xmax = Math.max(xRange[0], xRange[1]);\r\n  const ymin = Math.min(yRange[0], yRange[1]);\r\n  const ymax = Math.max(yRange[0], yRange[1]);\r\n\r\n  // Persist initial step when mode=\"world\" and no step provided\r\n  const initStepRef = React.useRef<{ sx: number; sy: number } | null>(null);\r\n  if (mode === \"world\" && !initStepRef.current) {\r\n    const sx0 = (xmax - xmin) / Math.max(1, countX - 1);\r\n    const sy0 = (ymax - ymin) / Math.max(1, countY - 1);\r\n    initStepRef.current = { sx: sx0, sy: sy0 };\r\n  }\r\n\r\n  const arrows = React.useMemo(() => {\r\n    const nodes: React.ReactNode[] = [];\r\n\r\n    if (mode === \"world\") {\r\n      const sx = stepX ?? initStepRef.current!.sx;\r\n      const sy = stepY ?? initStepRef.current!.sy;\r\n      const [ox, oy] = origin;\r\n      // index ranges covering viewport\r\n      const iMin = Math.ceil((xmin - ox) / sx);\r\n      const iMax = Math.floor((xmax - ox) / sx);\r\n      const jMin = Math.ceil((ymin - oy) / sy);\r\n      const jMax = Math.floor((ymax - oy) / sy);\r\n      const base = (scale ?? (0.35 * Math.hypot(sx, sy)));\r\n      for (let j = jMin; j <= jMax; j++) {\r\n        for (let i = iMin; i <= iMax; i++) {\r\n          const x = ox + i * sx;\r\n          const y = oy + j * sy;\r\n          const vec = v(x, y);\r\n          const vx = Array.isArray(vec) ? vec[0] : vec.vx;\r\n          const vy = Array.isArray(vec) ? vec[1] : vec.vy;\r\n          let mx = vx, my = vy;\r\n          if (normalize) {\r\n            const m = Math.hypot(vx, vy) || 1;\r\n            mx = (vx / m) * base;\r\n            my = (vy / m) * base;\r\n          } else {\r\n            const s = scale ?? 1;\r\n            mx = vx * s;\r\n            my = vy * s;\r\n          }\r\n          nodes.push(\r\n            <Vector2D key={`${i}-${j}`} x1={x} y1={y} x2={x + mx} y2={y + my} stroke={color} strokeWidth={strokeWidth} headSize={headSize} />\r\n          );\r\n        }\r\n      }\r\n      return nodes;\r\n    } else {\r\n      // viewport-tied lattice (previous behavior)\r\n      const dx = (xmax - xmin) / Math.max(1, countX - 1);\r\n      const dy = (ymax - ymin) / Math.max(1, countY - 1);\r\n      const base = (scale ?? (0.35 * Math.hypot(dx, dy)));\r\n      for (let iy = 0; iy < countY; iy++) {\r\n        for (let ix = 0; ix < countX; ix++) {\r\n          const x = xmin + ix * dx;\r\n          const y = ymin + iy * dy;\r\n          const vec = v(x, y);\r\n          const vx = Array.isArray(vec) ? vec[0] : vec.vx;\r\n          const vy = Array.isArray(vec) ? vec[1] : vec.vy;\r\n          let mx = vx, my = vy;\r\n          if (normalize) {\r\n            const m = Math.hypot(vx, vy) || 1;\r\n            mx = (vx / m) * base;\r\n            my = (vy / m) * base;\r\n          } else {\r\n            const s = scale ?? 1;\r\n            mx = vx * s;\r\n            my = vy * s;\r\n          }\r\n          nodes.push(\r\n            <Vector2D key={`${ix}-${iy}`} x1={x} y1={y} x2={x + mx} y2={y + my} stroke={color} strokeWidth={strokeWidth} headSize={headSize} />\r\n          );\r\n        }\r\n      }\r\n      return nodes;\r\n    }\r\n  }, [mode, v, origin, stepX, stepY, xmin, xmax, ymin, ymax, countX, countY, normalize, scale, color, strokeWidth, headSize]);\r\n\r\n  return <g>{arrows}</g>;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Heatmap2DProps = {\r\n  f: (x: number, y: number) => number;\r\n  // Sampling layout\r\n  mode?: \"world\" | \"viewport\"; // world: tiles are fixed in world coords; viewport: tiles span the viewport evenly\r\n  origin?: [number, number]; // for mode=\"world\" tiling alignment (default [0,0])\r\n  stepX?: number; // world tile width for mode=\"world\"\r\n  stepY?: number; // world tile height for mode=\"world\"\r\n  countX?: number; // used for mode=\"viewport\" or to derive default step in mode=\"world\"\r\n  countY?: number; // used for mode=\"viewport\" or to derive default step in mode=\"world\"\r\n  // Styling\r\n  valueRange?: [number, number]; // if omitted, auto from sampled min/max\r\n  colorMap?: (t: number) => string; // t in [0,1]\r\n  opacity?: number;\r\n  clip?: boolean;\r\n};\r\n\r\nfunction defaultColorMap(t: number): string {\r\n  // simple blue -> cyan -> yellow -> red gradient\r\n  const clamp = (v:number)=>Math.max(0,Math.min(1,v));\r\n  t = clamp(t);\r\n  const r = t < 0.5 ? 0 : Math.round(510*(t-0.5));\r\n  const g = t < 0.5 ? Math.round(510*t) : Math.round(510*(1 - (t-0.5)));\r\n  const b = t < 0.5 ? Math.round(255) : Math.round(255*(1 - (t-0.5)*2));\r\n  return `rgb(${r},${g},${b})`;\r\n}\r\n\r\nexport function Heatmap2D({ f, mode = \"world\", origin = [0,0], stepX, stepY, countX = 40, countY = 30, valueRange, colorMap = defaultColorMap, opacity = 0.9, clip = true }: Heatmap2DProps) {\r\n  const { xRange, yRange, worldToScreen, clipPathId } = usePlot();\r\n  const xmin = Math.min(xRange[0], xRange[1]);\r\n  const xmax = Math.max(xRange[0], xRange[1]);\r\n  const ymin = Math.min(yRange[0], yRange[1]);\r\n  const ymax = Math.max(yRange[0], yRange[1]);\r\n\r\n  // Persist initial tile size for mode=\"world\" if not provided\r\n  const initStepRef = React.useRef<{ sx: number; sy: number } | null>(null);\r\n  if (mode === \"world\" && !initStepRef.current) {\r\n    const sx0 = (xmax - xmin) / Math.max(1, countX);\r\n    const sy0 = (ymax - ymin) / Math.max(1, countY);\r\n    initStepRef.current = { sx: sx0, sy: sy0 };\r\n  }\r\n\r\n  const rects = React.useMemo(() => {\r\n    let minv = Infinity, maxv = -Infinity;\r\n    const tiles: Array<{ x0:number; y0:number; x1:number; y1:number; v:number }>[] = [] as any;\r\n\r\n    if (mode === \"world\") {\r\n      const sx = stepX ?? initStepRef.current!.sx;\r\n      const sy = stepY ?? initStepRef.current!.sy;\r\n      const [ox, oy] = origin;\r\n      const iMin = Math.floor((xmin - ox) / sx) - 1;\r\n      const iMax = Math.ceil((xmax - ox) / sx) + 1;\r\n      const jMin = Math.floor((ymin - oy) / sy) - 1;\r\n      const jMax = Math.ceil((ymax - oy) / sy) + 1;\r\n      const rows: any[] = [];\r\n      for (let j = jMin; j <= jMax; j++) {\r\n        const row: any[] = [];\r\n        for (let i = iMin; i <= iMax; i++) {\r\n          const x0 = ox + i * sx, y0 = oy + j * sy;\r\n          const x1 = x0 + sx, y1 = y0 + sy;\r\n          const xc = (x0 + x1) * 0.5, yc = (y0 + y1) * 0.5;\r\n          const v = f(xc, yc);\r\n          if (v < minv) minv = v; if (v > maxv) maxv = v;\r\n          row.push({ x0, y0, x1, y1, v });\r\n        }\r\n        rows.push(row);\r\n      }\r\n      (tiles as any).push(...rows);\r\n    } else {\r\n      // viewport-anchored tiles\r\n      const sx = (xmax - xmin) / Math.max(1, countX);\r\n      const sy = (ymax - ymin) / Math.max(1, countY);\r\n      for (let j = 0; j < countY; j++) {\r\n        const row: any[] = [];\r\n        for (let i = 0; i < countX; i++) {\r\n          const x0 = xmin + i * sx, y0 = ymin + j * sy;\r\n          const x1 = x0 + sx, y1 = y0 + sy;\r\n          const xc = (x0 + x1) * 0.5, yc = (y0 + y1) * 0.5;\r\n          const v = f(xc, yc);\r\n          if (v < minv) minv = v; if (v > maxv) maxv = v;\r\n          row.push({ x0, y0, x1, y1, v });\r\n        }\r\n        (tiles as any).push(row);\r\n      }\r\n    }\r\n\r\n    if (valueRange) { minv = valueRange[0]; maxv = valueRange[1]; }\r\n    const clampV = (v:number)=>Math.max(minv, Math.min(maxv, v));\r\n    const tOf = (v:number)=> (maxv === minv ? 0.5 : (clampV(v) - minv) / (maxv - minv));\r\n\r\n    const nodes: React.ReactNode[] = [];\r\n    let key = 0;\r\n    for (const row of tiles as Array<Array<{x0:number;y0:number;x1:number;y1:number;v:number}>>) {\r\n      for (const tile of row) {\r\n        const p = worldToScreen(tile.x0, tile.y0);\r\n        const p2 = worldToScreen(tile.x1, tile.y1);\r\n        const w = Math.abs(p2.x - p.x);\r\n        const h = Math.abs(p2.y - p.y);\r\n        const fill = colorMap(tOf(tile.v));\r\n        nodes.push(<rect key={key++} x={Math.min(p.x, p2.x)} y={Math.min(p.y, p2.y)} width={Math.max(1, w)} height={Math.max(1, h)} fill={fill} opacity={opacity} />);\r\n      }\r\n    }\r\n    return nodes;\r\n  }, [mode, f, origin, stepX, stepY, countX, countY, xmin, xmax, ymin, ymax, worldToScreen, valueRange, colorMap, opacity]);\r\n\r\n  return <g clipPath={clip ? `url(#${clipPathId})` : undefined}>{rects}</g>;\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Implicit2DProps = {\r\n  F: (x: number, y: number) => number; // contour of F(x,y) = level\r\n  level?: number;\r\n  countX?: number;\r\n  countY?: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  clip?: boolean;\r\n};\r\n\r\n// Linear interpolation helper\r\nfunction lerp(a:number,b:number,t:number){return a+(b-a)*t}\r\n\r\nexport function Implicit2D({ F, level = 0, countX = 96, countY = 72, stroke = \"#111827\", strokeWidth = 1.5, strokeDasharray, clip = true }: Implicit2DProps) {\r\n  const { xRange, yRange, worldToScreen, clipPathId } = usePlot();\r\n  const xmin = Math.min(xRange[0], xRange[1]);\r\n  const xmax = Math.max(xRange[0], xRange[1]);\r\n  const ymin = Math.min(yRange[0], yRange[1]);\r\n  const ymax = Math.max(yRange[0], yRange[1]);\r\n  const dx = (xmax - xmin) / Math.max(1, countX);\r\n  const dy = (ymax - ymin) / Math.max(1, countY);\r\n\r\n  const segs = React.useMemo(() => {\r\n    // Sample grid values at cell corners\r\n    const vals: number[][] = [];\r\n    for (let iy = 0; iy <= countY; iy++) {\r\n      const row: number[] = [];\r\n      for (let ix = 0; ix <= countX; ix++) {\r\n        const x = xmin + ix * dx;\r\n        const y = ymin + iy * dy;\r\n        row.push(F(x, y) - level);\r\n      }\r\n      vals.push(row);\r\n    }\r\n\r\n    const lines: Array<string> = [];\r\n    // Marching squares per cell\r\n    for (let iy = 0; iy < countY; iy++) {\r\n      for (let ix = 0; ix < countX; ix++) {\r\n        const v00 = vals[iy][ix];\r\n        const v10 = vals[iy][ix+1];\r\n        const v01 = vals[iy+1][ix];\r\n        const v11 = vals[iy+1][ix+1];\r\n        const x0 = xmin + ix * dx;\r\n        const y0 = ymin + iy * dy;\r\n        const x1 = x0 + dx;\r\n        const y1 = y0 + dy;\r\n\r\n        const idx = (v00>0?1:0) | (v10>0?2:0) | (v11>0?4:0) | (v01>0?8:0);\r\n        if (idx === 0 || idx === 15) continue;\r\n\r\n        // helper: edge interpolation returns screen coords\r\n        const edgePoint = (edge:number)=>{\r\n          switch(edge){\r\n            case 0: { // bottom: (x0,y0)-(x1,y0)\r\n              const t = v10===v00?0.5:(0 - v00)/(v10 - v00);\r\n              const xs = lerp(x0,x1,t); const ys = y0; return worldToScreen(xs,ys);\r\n            }\r\n            case 1: { // right: (x1,y0)-(x1,y1)\r\n              const t = v11===v10?0.5:(0 - v10)/(v11 - v10);\r\n              const xs = x1; const ys = lerp(y0,y1,t); return worldToScreen(xs,ys);\r\n            }\r\n            case 2: { // top: (x0,y1)-(x1,y1)\r\n              const t = v11===v01?0.5:(0 - v01)/(v11 - v01);\r\n              const xs = lerp(x0,x1,t); const ys = y1; return worldToScreen(xs,ys);\r\n            }\r\n            case 3: { // left: (x0,y0)-(x0,y1)\r\n              const t = v01===v00?0.5:(0 - v00)/(v01 - v00);\r\n              const xs = x0; const ys = lerp(y0,y1,t); return worldToScreen(xs,ys);\r\n            }\r\n          }\r\n          return worldToScreen(x0,y0);\r\n        };\r\n\r\n        // cases from standard marching squares; produce 0,1 or 2 segments\r\n        const table: {[k:number]: [number,number][]} = {\r\n          1:[[3,0]], 2:[[0,1]], 3:[[3,1]], 4:[[1,2]], 5:[[3,2],[0,1]], 6:[[0,2]], 7:[[3,2]],\r\n          8:[[2,3]], 9:[[0,2]], 10:[[1,3],[0,2]], 11:[[1,2]], 12:[[1,3]], 13:[[0,1]], 14:[[3,0]]\r\n        };\r\n        const segEdges = table[idx] || [];\r\n        for (const [e1,e2] of segEdges) {\r\n          const p1 = edgePoint(e1); const p2 = edgePoint(e2);\r\n          lines.push(`M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`);\r\n        }\r\n      }\r\n    }\r\n    return lines;\r\n  }, [F, level, countX, countY, xmin, ymin, dx, dy, worldToScreen]);\r\n\r\n  return (\r\n    <g clipPath={clip ? `url(#${clipPathId})` : undefined}>\r\n      {segs.map((d,i)=>(<path key={i} d={d} stroke={stroke} strokeWidth={strokeWidth} strokeDasharray={strokeDasharray} fill=\"none\"/>))}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Implicit2D } from \"./Implicit2D\";\r\n\r\nexport type Contour2DProps = {\r\n  F: (x: number, y: number) => number;\r\n  levels: number[];\r\n  colors?: string[]; // optional per-level colors\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  countX?: number;\r\n  countY?: number;\r\n};\r\n\r\nexport function Contour2D({ F, levels, colors, strokeWidth = 1, strokeDasharray, countX, countY }: Contour2DProps) {\r\n  return (\r\n    <g>\r\n      {levels.map((lv, i) => (\r\n        <Implicit2D key={i} F={F} level={lv} stroke={colors?.[i % (colors?.length || 1)] || \"#1f2937\"} strokeWidth={strokeWidth} strokeDasharray={strokeDasharray} countX={countX} countY={countY} />\r\n      ))}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Parametric2D } from \"./Parametric2D\";\r\n\r\nexport type PolarFunction2DProps = {\r\n  r: (theta: number) => number;\r\n  thetaRange: [number, number];\r\n  samples?: number;\r\n  stroke?: string;\r\n  strokeWidth?: number;\r\n  strokeDasharray?: string;\r\n  clip?: boolean;\r\n  overscan?: number;\r\n};\r\n\r\nexport function PolarFunction2D({ r, thetaRange, samples = 800, stroke = \"#111827\", strokeWidth = 2, strokeDasharray, clip = true, overscan = 0 }: PolarFunction2DProps) {\r\n  return (\r\n    <Parametric2D\r\n      x={(t:number) => r(t) * Math.cos(t)}\r\n      y={(t:number) => r(t) * Math.sin(t)}\r\n      tRange={thetaRange}\r\n      samples={samples}\r\n      stroke={stroke}\r\n      strokeWidth={strokeWidth}\r\n      strokeDasharray={strokeDasharray}\r\n      clip={clip}\r\n      domainFollowsViewport={false}\r\n      overscan={overscan}\r\n    />\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\n// Nota sobre coordenadas:\r\n// `mouse.sx` y `mouse.sy` ya están compensadas por cualquier escala CSS externa\r\n// (ver lógica en Plot2D donde se aplica factor width/rect.width). Por eso aquí\r\n// podemos usarlas directamente como coordenadas \"lógicas\" del SVG sin aplicar\r\n// ninguna corrección adicional. Si en el futuro se reemplaza la estrategia de\r\n// escalado (por ejemplo dimensionando realmente el SVG en vez de usar transform),\r\n// este componente no necesita cambios porque consumirá los valores normalizados\r\n// que Plot2D le entrega.\r\n\r\nexport type Crosshair2DProps = {\r\n  color?: string;\r\n  strokeWidth?: number;\r\n  showLabels?: boolean;\r\n  format?: (x:number,y:number)=>string;\r\n};\r\n\r\nexport function Crosshair2D({ color = \"#6b7280\", strokeWidth = 1, showLabels = true, format }: Crosshair2DProps) {\r\n  const { mouse, clipPathId, margin, innerWidth, innerHeight } = usePlot();\r\n  if (!mouse?.inside) return null;\r\n  const sx = margin.left + Math.max(0, Math.min(innerWidth, mouse.sx - margin.left));\r\n  const sy = margin.top + Math.max(0, Math.min(innerHeight, mouse.sy - margin.top));\r\n  const label = format ? format(mouse.x, mouse.y) : `(${mouse.x.toFixed(3)}, ${mouse.y.toFixed(3)})`;\r\n  return (\r\n    <g>\r\n      <g clipPath={`url(#${clipPathId})`}>\r\n        <line x1={margin.left} y1={sy} x2={margin.left + innerWidth} y2={sy} stroke={color} strokeWidth={strokeWidth} strokeDasharray=\"4 4\" />\r\n        <line x1={sx} y1={margin.top} x2={sx} y2={margin.top + innerHeight} stroke={color} strokeWidth={strokeWidth} strokeDasharray=\"4 4\" />\r\n      </g>\r\n      {showLabels && (\r\n        <foreignObject x={margin.left} y={margin.top} width={innerWidth} height={innerHeight}>\r\n          <div style={{ position:'relative', width:'100%', height:'100%', pointerEvents:'none', fontFamily:'system-ui, Segoe UI, Roboto, sans-serif', fontSize: 12 }}>\r\n            <div style={{ position:'absolute', left: sx - margin.left + 8, top: sy - margin.top - 8, transform:'translate(0,-100%)', background:'rgba(17,24,39,0.75)', color:'#fff', padding:'2px 6px', borderRadius:4, whiteSpace:'nowrap' }}>{label}</div>\r\n          </div>\r\n        </foreignObject>\r\n      )}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type LegendItem = {\r\n  label: React.ReactNode;\r\n  color?: string;\r\n  strokeDasharray?: string;\r\n  marker?: React.ReactNode; // optional custom marker\r\n};\r\n\r\nexport type Legend2DProps = {\r\n  items: LegendItem[];\r\n  position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\r\n  padding?: number;\r\n  bg?: string;\r\n  opacity?: number;\r\n};\r\n\r\nexport function Legend2D({ items, position = 'top-right', padding = 8, bg = 'rgba(255,255,255,0.9)', opacity = 1 }: Legend2DProps) {\r\n  const { margin, innerWidth, innerHeight } = usePlot();\r\n  const x0 = margin.left;\r\n  const y0 = margin.top;\r\n  const width = innerWidth;\r\n  const height = innerHeight;\r\n\r\n  const isTR = position === 'top-right';\r\n  const isBR = position === 'bottom-right';\r\n  const top = (position.startsWith('top') ? y0 + padding : y0 + height - padding);\r\n  const left = (isTR || isBR ? x0 + width - padding : x0 + padding);\r\n  const align = (isTR || isBR) ? 'right' as const : 'left' as const;\r\n\r\n  return (\r\n    <foreignObject x={margin.left} y={margin.top} width={innerWidth} height={innerHeight} opacity={opacity}>\r\n      <div style={{ position:'relative', width:'100%', height:'100%', pointerEvents:'none', fontFamily:'system-ui, Segoe UI, Roboto, sans-serif', fontSize: 12 }}>\r\n        <div style={{ position:'absolute', left: left - margin.left, top: top - margin.top, transform:`translate(${align==='right'?'-100%':'0'}, ${position.startsWith('top')? '0' : '-100%'})`, background:bg, border:'1px solid #e5e7eb', borderRadius:6, padding:8, boxShadow:'0 1px 3px rgba(0,0,0,0.1)' }}>\r\n          {items.map((it, i)=> (\r\n            <div key={i} style={{ display:'flex', alignItems:'center', gap:8, margin:'4px 0', whiteSpace:'nowrap' }}>\r\n              {it.marker ?? <svg width={18} height={10} style={{ flex:'0 0 auto' }}>\r\n                <line x1={0} y1={5} x2={18} y2={5} stroke={it.color ?? '#111'} strokeWidth={2} strokeDasharray={it.strokeDasharray} />\r\n              </svg>}\r\n              <div style={{ pointerEvents:'auto' }}>{it.label}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </foreignObject>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Title2DProps = {\r\n  children: React.ReactNode;\r\n  align?: 'left' | 'center' | 'right';\r\n  /** Vertical offset in pixels from the top margin area. Positive moves down. */\r\n  offsetY?: number;\r\n};\r\n\r\nexport function Title2D({ children, align = 'center', offsetY = 2 }: Title2DProps) {\r\n  const { margin, innerWidth } = usePlot();\r\n  const x = align === 'left' ? margin.left + 4 : align === 'right' ? margin.left + innerWidth - 4 : margin.left + innerWidth / 2;\r\n  const transform = align === 'left' ? 'translate(0, 0)' : align === 'right' ? 'translate(-100%, 0)' : 'translate(-50%, 0)';\r\n  return (\r\n    <foreignObject x={margin.left} y={0} width={innerWidth} height={margin.top}>\r\n      <div style={{ position:'relative', width:'100%', height:'100%', pointerEvents:'none', fontFamily:'system-ui, Segoe UI, Roboto, sans-serif' }}>\r\n        <div style={{ position:'absolute', left: x - margin.left, top: offsetY, transform, fontSize: 14, fontWeight: 600 }}>{children}</div>\r\n      </div>\r\n    </foreignObject>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type GradientStop = {\r\n  offset: number | string; // 0..1 or '50%'\r\n  color: string;\r\n  opacity?: number;\r\n};\r\n\r\nexport type LinearGradient2DProps = {\r\n  stops: GradientStop[];\r\n  // Optional gradient line expressed in WORLD coordinates (mapped to pixels).\r\n  x1?: number;\r\n  y1?: number;\r\n  x2?: number;\r\n  y2?: number;\r\n  // Optional target rectangle in WORLD coordinates (where the gradient is painted).\r\n  // If omitted, the whole inner plotting area is used.\r\n  x?: number;\r\n  y?: number;\r\n  width?: number;\r\n  height?: number;\r\n  opacity?: number;\r\n  children: React.ReactNode; // clip geometry (SVG)\r\n  overlay?: React.ReactNode; // visible overlay (labels, etc.)\r\n  // Coordinate space for the gradient line and the default paint rect.\r\n  // 'world' => moves with viewport (default). 'screen' => fixed on screen.\r\n  space?: 'world' | 'screen';\r\n  // Anchoring: when 'mask' and no explicit rect/line, derive from mask bbox so it sticks to shape\r\n  anchor?: 'mask' | 'world' | 'screen';\r\n  // What parts of children reveal the paint through the mask\r\n  // 'fill' (default): interior only, 'stroke': outline only, 'both': interior + outline\r\n  reveal?: 'fill' | 'stroke' | 'both';\r\n};\r\n\r\nfunction toMask(node: React.ReactNode): React.ReactNode {\r\n  if (!React.isValidElement(node)) return node;\r\n  const props: any = node.props || {};\r\n  const clonedChildren = props.children ? React.Children.map(props.children, toMask) : props.children;\r\n  const extra: any = {\r\n    fill: '#fff',\r\n    stroke: 'none',\r\n    opacity: 1,\r\n  };\r\n  if (Object.prototype.hasOwnProperty.call(props, 'clip')) extra.clip = false;\r\n  return React.cloneElement(node as any, extra, clonedChildren);\r\n}\r\n\r\nexport function LinearGradient2D({ stops, x1, y1, x2, y2, x, y, width, height, opacity = 1, children, overlay, space = 'world', anchor = 'mask', reveal = 'fill' }: LinearGradient2DProps) {\r\n  const { margin, innerWidth, innerHeight, xRange, yRange, worldToScreen, clipPathId } = usePlot();\r\n  const idBase = (React as any).useId ? React.useId() : Math.random().toString(36).slice(2);\r\n  const gradId = `lg-${idBase}`;\r\n  const maskId = `lgm-${idBase}`;\r\n  const measureRef = React.useRef<SVGGElement | null>(null);\r\n  const [bbox, setBbox] = React.useState<{ x:number; y:number; width:number; height:number } | null>(null);\r\n  React.useLayoutEffect(() => {\r\n    const el = measureRef.current;\r\n    if (!el) return;\r\n    try {\r\n      const b = el.getBBox();\r\n      if (isFinite(b.x) && isFinite(b.y) && isFinite(b.width) && isFinite(b.height)) {\r\n        setBbox({ x: b.x, y: b.y, width: b.width, height: b.height });\r\n      }\r\n    } catch {}\r\n  }, [children, xRange[0], xRange[1], yRange[0], yRange[1]]);\r\n\r\n  // Compute paint rectangle in pixel space\r\n  let sx = margin.left, sy = margin.top, sw = innerWidth, sh = innerHeight;\r\n  if (typeof x === 'number' && typeof y === 'number' && typeof width === 'number' && typeof height === 'number') {\r\n    const p0 = worldToScreen(x, y);\r\n    const p1 = worldToScreen(x + width, y + height);\r\n    sx = Math.min(p0.x, p1.x);\r\n    sy = Math.min(p0.y, p1.y);\r\n    sw = Math.abs(p1.x - p0.x);\r\n    sh = Math.abs(p1.y - p0.y);\r\n  } else if (anchor === 'mask' && bbox) {\r\n    sx = bbox.x; sy = bbox.y; sw = bbox.width; sh = bbox.height;\r\n  } else if (space === 'world') {\r\n    // Default paint rect tied to the current world viewport\r\n    const p0 = worldToScreen(xRange[0], yRange[0]);\r\n    const p1 = worldToScreen(xRange[1], yRange[1]);\r\n    sx = Math.min(p0.x, p1.x);\r\n    sy = Math.min(p0.y, p1.y);\r\n    sw = Math.abs(p1.x - p0.x);\r\n    sh = Math.abs(p1.y - p0.y);\r\n  }\r\n\r\n  // Gradient line in pixel space\r\n  let gx1: number, gy1: number, gx2: number, gy2: number;\r\n  if (anchor === 'mask' && bbox && !(typeof x1 === 'number' || typeof y1 === 'number' || typeof x2 === 'number' || typeof y2 === 'number')) {\r\n    // Default gradient line across the center of mask bbox\r\n    gx1 = sx; gy1 = sy + sh / 2; gx2 = sx + sw; gy2 = sy + sh / 2;\r\n  } else if (space === 'world') {\r\n    if (typeof x1 === 'number' || typeof y1 === 'number' || typeof x2 === 'number' || typeof y2 === 'number') {\r\n      const p1 = worldToScreen(x1 ?? xRange[0], y1 ?? (yRange[0] + yRange[1]) / 2);\r\n      const p2 = worldToScreen(x2 ?? xRange[1], y2 ?? (yRange[0] + yRange[1]) / 2);\r\n      gx1 = p1.x; gy1 = p1.y; gx2 = p2.x; gy2 = p2.y;\r\n    } else {\r\n      // Default: world left->right across current world center\r\n      const p1 = worldToScreen(xRange[0], (yRange[0] + yRange[1]) / 2);\r\n      const p2 = worldToScreen(xRange[1], (yRange[0] + yRange[1]) / 2);\r\n      gx1 = p1.x; gy1 = p1.y; gx2 = p2.x; gy2 = p2.y;\r\n    }\r\n  } else {\r\n    // screen-locked\r\n    gx1 = sx; gy1 = sy + sh / 2; gx2 = sx + sw; gy2 = sy + sh / 2;\r\n  }\r\n\r\n  // Clone children for mask according to reveal mode\r\n  function toMask(node: React.ReactNode): React.ReactNode {\r\n    if (!React.isValidElement(node)) return node;\r\n    const props: any = node.props || {};\r\n    const clonedChildren = props.children ? React.Children.map(props.children, toMask) : props.children;\r\n    const extra: any = {};\r\n    if (reveal === 'fill') {\r\n      extra.fill = '#fff'; extra.stroke = 'none';\r\n    } else if (reveal === 'stroke') {\r\n      extra.fill = 'none'; extra.stroke = '#fff';\r\n      // keep user's strokeWidth if any; otherwise default reasonable width\r\n      if (props.strokeWidth == null) extra.strokeWidth = 2;\r\n    } else { // both\r\n      extra.fill = '#fff'; extra.stroke = '#fff';\r\n      if (props.strokeWidth == null) extra.strokeWidth = 1;\r\n    }\r\n    extra.opacity = 1;\r\n    if (Object.prototype.hasOwnProperty.call(props, 'clip')) extra.clip = false;\r\n    return React.cloneElement(node as any, extra, clonedChildren);\r\n  }\r\n\r\n  return (\r\n    <g>\r\n      {/* Hidden measuring group to compute mask bbox in screen space */}\r\n      <g ref={measureRef} style={{ opacity: 0, pointerEvents: 'none' as any }}>{children}</g>\r\n      <defs>\r\n        <linearGradient id={gradId} x1={gx1} y1={gy1} x2={gx2} y2={gy2} gradientUnits=\"userSpaceOnUse\">\r\n          {stops.map((s, i) => (\r\n            <stop key={i} offset={typeof s.offset === 'number' ? String(s.offset) : s.offset} stopColor={s.color} stopOpacity={s.opacity ?? 1} />\r\n          ))}\r\n        </linearGradient>\r\n        <mask id={maskId} maskUnits=\"userSpaceOnUse\">\r\n          {/* Black background (fully transparent) */}\r\n          <rect x={sx} y={sy} width={sw} height={sh} fill=\"#000\" />\r\n          {/* Children painted in white to reveal the gradient */}\r\n          <g>{React.Children.map(children as any, toMask)}</g>\r\n        </mask>\r\n      </defs>\r\n      <rect x={sx} y={sy} width={sw} height={sh} fill={`url(#${gradId})`} mask={`url(#${maskId})`} opacity={opacity} />\r\n      {overlay ? <g>{overlay}</g> : null}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\nimport type { GradientStop } from \"./LinearGradient2D\";\r\n\r\nexport type RadialGradient2DProps = {\r\n  stops: GradientStop[];\r\n  // Optional world-space center/radius\r\n  cx?: number;\r\n  cy?: number;\r\n  r?: number; // world units (mapped along X scale)\r\n  fx?: number;\r\n  fy?: number;\r\n  // Optional paint area in world units (defaults to inner plot)\r\n  x?: number;\r\n  y?: number;\r\n  width?: number;\r\n  height?: number;\r\n  opacity?: number;\r\n  children: React.ReactNode;\r\n  overlay?: React.ReactNode;\r\n  // Coordinate space: 'world' (default, moves with viewport) or 'screen' (fixed to pixels)\r\n  space?: 'world' | 'screen';\r\n  // Anchoring: when 'mask' (default) and cx/cy not provided, center/r default to the mask's bbox.\r\n  anchor?: 'mask' | 'world' | 'screen';\r\n  // What parts of children reveal the paint through the mask: 'fill' | 'stroke' | 'both'\r\n  reveal?: 'fill' | 'stroke' | 'both';\r\n};\r\n\r\nfunction makeToMask(revealMode: 'fill' | 'stroke' | 'both') {\r\n  function toMask(node: React.ReactNode): React.ReactNode {\r\n    if (!React.isValidElement(node)) return node;\r\n    const props: any = node.props || {};\r\n    const clonedChildren = props.children ? React.Children.map(props.children, toMask) : props.children;\r\n    const extra: any = {};\r\n    if (revealMode === 'fill') {\r\n      extra.fill = '#fff'; extra.stroke = 'none';\r\n    } else if (revealMode === 'stroke') {\r\n      extra.fill = 'none'; extra.stroke = '#fff';\r\n      if (props.strokeWidth == null) extra.strokeWidth = 2;\r\n    } else {\r\n      extra.fill = '#fff'; extra.stroke = '#fff';\r\n      if (props.strokeWidth == null) extra.strokeWidth = 1;\r\n    }\r\n    extra.opacity = 1;\r\n    if (Object.prototype.hasOwnProperty.call(props, 'clip')) extra.clip = false;\r\n    return React.cloneElement(node as any, extra, clonedChildren);\r\n  }\r\n  return toMask;\r\n}\r\n\r\nexport function RadialGradient2D({ stops, cx, cy, r, fx, fy, x, y, width, height, opacity = 1, children, overlay, space = 'world', anchor = 'mask', reveal = 'fill' }: RadialGradient2DProps) {\r\n  const { margin, innerWidth, innerHeight, xRange, yRange, worldToScreen, clipPathId } = usePlot();\r\n  const idBase = (React as any).useId ? React.useId() : Math.random().toString(36).slice(2);\r\n  const gradId = `rg-${idBase}`;\r\n  const maskId = `rgm-${idBase}`;\r\n  const measureRef = React.useRef<SVGGElement | null>(null);\r\n  const [bbox, setBbox] = React.useState<{ x:number; y:number; width:number; height:number } | null>(null);\r\n  React.useLayoutEffect(() => {\r\n    const el = measureRef.current;\r\n    if (!el) return;\r\n    try {\r\n      const b = el.getBBox();\r\n      if (isFinite(b.x) && isFinite(b.y) && isFinite(b.width) && isFinite(b.height)) {\r\n        setBbox({ x: b.x, y: b.y, width: b.width, height: b.height });\r\n      }\r\n    } catch {}\r\n  }, [children, xRange[0], xRange[1], yRange[0], yRange[1]]);\r\n\r\n  // Paint rectangle in pixels\r\n  let sx = margin.left, sy = margin.top, sw = innerWidth, sh = innerHeight;\r\n  if (typeof x === 'number' && typeof y === 'number' && typeof width === 'number' && typeof height === 'number') {\r\n    const p0 = worldToScreen(x, y);\r\n    const p1 = worldToScreen(x + width, y + height);\r\n    sx = Math.min(p0.x, p1.x);\r\n    sy = Math.min(p0.y, p1.y);\r\n    sw = Math.abs(p1.x - p0.x);\r\n    sh = Math.abs(p1.y - p0.y);\r\n  } else if (anchor === 'mask' && bbox) {\r\n    sx = bbox.x; sy = bbox.y; sw = bbox.width; sh = bbox.height;\r\n  } else if (space === 'world') {\r\n    // Paint rect follows world viewport by default\r\n    const p0 = worldToScreen(xRange[0], yRange[0]);\r\n    const p1 = worldToScreen(xRange[1], yRange[1]);\r\n    sx = Math.min(p0.x, p1.x);\r\n    sy = Math.min(p0.y, p1.y);\r\n    sw = Math.abs(p1.x - p0.x);\r\n    sh = Math.abs(p1.y - p0.y);\r\n  }\r\n\r\n  // Center/radius in pixels\r\n  const defaultCxW = (xRange[0] + xRange[1]) / 2;\r\n  const defaultCyW = (yRange[0] + yRange[1]) / 2;\r\n  let cpx: number, cpy: number;\r\n  if (anchor === 'mask' && bbox && (typeof cx !== 'number' && typeof cy !== 'number')) {\r\n    cpx = bbox.x + bbox.width / 2;\r\n    cpy = bbox.y + bbox.height / 2;\r\n  } else if (space === 'world') {\r\n    const c = worldToScreen(cx ?? defaultCxW, cy ?? defaultCyW);\r\n    cpx = c.x; cpy = c.y;\r\n  } else {\r\n    cpx = sx + sw / 2; cpy = sy + sh / 2;\r\n  }\r\n\r\n  let rPx: number;\r\n  if (typeof r === 'number') {\r\n    if (space === 'world') {\r\n      const p0 = worldToScreen((cx ?? defaultCxW), (cy ?? defaultCyW));\r\n      const p1 = worldToScreen((cx ?? defaultCxW) + r, (cy ?? defaultCyW));\r\n      rPx = Math.abs(p1.x - p0.x);\r\n    } else {\r\n      rPx = r; // treat as pixels in screen space\r\n    }\r\n  } else if (anchor === 'mask' && bbox) {\r\n    rPx = Math.min(bbox.width, bbox.height) / 2;\r\n  } else {\r\n    rPx = Math.min(sw, sh) / 2;\r\n  }\r\n\r\n  let fpx: number, fpy: number;\r\n  if (typeof fx === 'number' || typeof fy === 'number') {\r\n    if (space === 'world') {\r\n      const fp = worldToScreen(fx ?? (cx ?? defaultCxW), fy ?? (cy ?? defaultCyW));\r\n      fpx = fp.x; fpy = fp.y;\r\n    } else {\r\n      fpx = fx ?? cpx; fpy = fy ?? cpy;\r\n    }\r\n  } else { fpx = cpx; fpy = cpy; }\r\n\r\n  return (\r\n    <g clipPath={`url(#${clipPathId})`}>\r\n      {/* Hidden measuring group to compute mask bbox in screen space */}\r\n      <g ref={measureRef} style={{ opacity: 0, pointerEvents: 'none' as any }}>{children}</g>\r\n      <defs>\r\n        <radialGradient id={gradId} cx={cpx} cy={cpy} r={rPx} fx={fpx} fy={fpy} gradientUnits=\"userSpaceOnUse\">\r\n          {stops.map((s, i) => (\r\n            <stop key={i} offset={typeof s.offset === 'number' ? String(s.offset) : s.offset} stopColor={s.color} stopOpacity={s.opacity ?? 1} />\r\n          ))}\r\n        </radialGradient>\r\n        <mask id={maskId} maskUnits=\"userSpaceOnUse\">\r\n          <rect x={sx} y={sy} width={sw} height={sh} fill=\"#000\" />\r\n          <g>{React.Children.map(children as any, makeToMask(reveal))}</g>\r\n        </mask>\r\n      </defs>\r\n      <rect x={sx} y={sy} width={sw} height={sh} fill={`url(#${gradId})`} mask={`url(#${maskId})`} opacity={opacity} />\r\n      {overlay ? <g>{overlay}</g> : null}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { usePlot } from \"./context\";\r\n\r\nexport type Image2DProps = {\r\n  href: string;\r\n  x?: number;\r\n  y?: number;\r\n  width?: number;\r\n  height?: number;\r\n  preserveAspectRatio?: string; // e.g. 'xMidYMid meet'\r\n  opacity?: number;\r\n  children: React.ReactNode; // clip geometry\r\n  overlay?: React.ReactNode;\r\n  crossOrigin?: string;\r\n  // Coordinate space for default area: 'world' (moves with viewport) | 'screen' (fixed). Default 'world'.\r\n  space?: 'world' | 'screen';\r\n  // Anchoring: when 'mask' and no explicit rect, use mask bbox as paint rect so image sticks to shape\r\n  anchor?: 'mask' | 'world' | 'screen';\r\n  // Optional override for the IMAGE placement itself (x/y/width/height of the <image> tag).\r\n  // Interpreted in the same coordinate space as `space`:\r\n  //  - 'world': numbers are world units (converted via worldToScreen)\r\n  //  - 'screen': numbers are pixels\r\n  imageX?: number;\r\n  imageY?: number;\r\n  imageWidth?: number;\r\n  imageHeight?: number;\r\n  // What parts of children reveal the paint through the mask: 'fill' | 'stroke' | 'both'\r\n  reveal?: 'fill' | 'stroke' | 'both';\r\n};\r\n\r\nfunction toMaskFactory(revealMode: 'fill' | 'stroke' | 'both') {\r\n  function toMask(node: React.ReactNode): React.ReactNode {\r\n    if (!React.isValidElement(node)) return node;\r\n    const props: any = node.props || {};\r\n    const clonedChildren = props.children ? React.Children.map(props.children, toMask) : props.children;\r\n    const extra: any = {};\r\n    if (revealMode === 'fill') {\r\n      extra.fill = '#fff'; extra.stroke = 'none';\r\n    } else if (revealMode === 'stroke') {\r\n      extra.fill = 'none'; extra.stroke = '#fff';\r\n      if (props.strokeWidth == null) extra.strokeWidth = 2;\r\n    } else { // both\r\n      extra.fill = '#fff'; extra.stroke = '#fff';\r\n      if (props.strokeWidth == null) extra.strokeWidth = 1;\r\n    }\r\n    extra.opacity = 1;\r\n    if (Object.prototype.hasOwnProperty.call(props, 'clip')) extra.clip = false;\r\n    return React.cloneElement(node as any, extra, clonedChildren);\r\n  }\r\n  return toMask;\r\n}\r\n\r\nexport function Image2D({ href, x, y, width, height, preserveAspectRatio = 'xMidYMid meet', opacity = 1, children, overlay, crossOrigin, space = 'world', anchor = 'mask', imageX, imageY, imageWidth, imageHeight, reveal = 'fill' }: Image2DProps) {\r\n  const { margin, innerWidth, innerHeight, xRange, yRange, worldToScreen, clipPathId } = usePlot();\r\n  const idBase = (React as any).useId ? React.useId() : Math.random().toString(36).slice(2);\r\n  const maskId = `imm-${idBase}`;\r\n  const measureRef = React.useRef<SVGGElement | null>(null);\r\n  const [bbox, setBbox] = React.useState<{ x:number; y:number; width:number; height:number } | null>(null);\r\n  React.useLayoutEffect(() => {\r\n    const el = measureRef.current; if (!el) return;\r\n    try {\r\n      const b = el.getBBox();\r\n      if (isFinite(b.x) && isFinite(b.y) && isFinite(b.width) && isFinite(b.height)) setBbox({ x:b.x, y:b.y, width:b.width, height:b.height });\r\n    } catch {}\r\n  }, [children, xRange[0], xRange[1], yRange[0], yRange[1]]);\r\n\r\n  let sx = margin.left, sy = margin.top, sw = innerWidth, sh = innerHeight;\r\n  if (typeof x === 'number' && typeof y === 'number' && typeof width === 'number' && typeof height === 'number') {\r\n    const p0 = worldToScreen(x, y);\r\n    const p1 = worldToScreen(x + width, y + height);\r\n    sx = Math.min(p0.x, p1.x);\r\n    sy = Math.min(p0.y, p1.y);\r\n    sw = Math.abs(p1.x - p0.x);\r\n    sh = Math.abs(p1.y - p0.y);\r\n  } else if (anchor === 'mask' && bbox) {\r\n    sx = bbox.x; sy = bbox.y; sw = bbox.width; sh = bbox.height;\r\n  } else if (space === 'world') {\r\n    // Default to world viewport rect so image moves/scales with pan/zoom\r\n    const p0 = worldToScreen(xRange[0], yRange[0]);\r\n    const p1 = worldToScreen(xRange[1], yRange[1]);\r\n    sx = Math.min(p0.x, p1.x);\r\n    sy = Math.min(p0.y, p1.y);\r\n    sw = Math.abs(p1.x - p0.x);\r\n    sh = Math.abs(p1.y - p0.y);\r\n  }\r\n\r\n  // Image placement defaults to paint rect, but can be overridden by imageX/Y/Width/Height\r\n  let ix = sx, iy = sy, iw = sw, ih = sh;\r\n  const defaultXW = (xRange[0] + xRange[1]) / 2;\r\n  const defaultYW = (yRange[0] + yRange[1]) / 2;\r\n  if (typeof imageX === 'number' || typeof imageY === 'number') {\r\n    if (space === 'world') {\r\n      const p = worldToScreen(imageX ?? defaultXW, imageY ?? defaultYW);\r\n      if (typeof imageX === 'number') ix = p.x;\r\n      if (typeof imageY === 'number') iy = p.y;\r\n    } else {\r\n      if (typeof imageX === 'number') ix = imageX;\r\n      if (typeof imageY === 'number') iy = imageY;\r\n    }\r\n  }\r\n  if (typeof imageWidth === 'number') {\r\n    if (space === 'world') {\r\n      const p0 = worldToScreen(imageX ?? defaultXW, defaultYW);\r\n      const p1 = worldToScreen((imageX ?? defaultXW) + imageWidth, defaultYW);\r\n      iw = Math.abs(p1.x - p0.x);\r\n    } else {\r\n      iw = imageWidth;\r\n    }\r\n  }\r\n  if (typeof imageHeight === 'number') {\r\n    if (space === 'world') {\r\n      const q0 = worldToScreen(defaultXW, imageY ?? defaultYW);\r\n      const q1 = worldToScreen(defaultXW, (imageY ?? defaultYW) + imageHeight);\r\n      ih = Math.abs(q1.y - q0.y);\r\n    } else {\r\n      ih = imageHeight;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <g clipPath={`url(#${clipPathId})`}>\r\n      {/* Hidden measuring group to compute mask bbox in screen space */}\r\n      <g ref={measureRef} style={{ opacity: 0, pointerEvents: 'none' as any }}>{children}</g>\r\n      <defs>\r\n        <mask id={maskId} maskUnits=\"userSpaceOnUse\">\r\n          <rect x={sx} y={sy} width={sw} height={sh} fill=\"#000\" />\r\n          <g>{React.Children.map(children as any, toMaskFactory(reveal))}</g>\r\n        </mask>\r\n      </defs>\r\n      {/* eslint-disable-next-line react/forbid-elements */}\r\n      <image href={href} x={ix} y={iy} width={iw} height={ih} preserveAspectRatio={preserveAspectRatio as any} opacity={opacity} mask={`url(#${maskId})`} crossOrigin={crossOrigin as any} />\r\n      {overlay ? <g>{overlay}</g> : null}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { ThreeContext } from \"./threeContext\";\r\n\r\nexport type Plot3DProps = {\r\n  width: number;\r\n  height: number;\r\n  background?: string;\r\n  camera?: {\r\n    fov?: number;\r\n    near?: number;\r\n    far?: number;\r\n    position?: [number, number, number];\r\n    lookAt?: [number, number, number];\r\n  };\r\n  orbitControls?: boolean;\r\n  children?: React.ReactNode;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n};\r\n\r\nexport function Plot3D({\r\n  width,\r\n  height,\r\n  background = \"#fff\",\r\n  camera,\r\n  orbitControls = true,\r\n  children,\r\n  className,\r\n  style,\r\n}: Plot3DProps) {\r\n  const containerRef = React.useRef<HTMLDivElement | null>(null);\r\n  // Keep these in state so React re-render happens once initialized\r\n  const [three, setThree] = React.useState<any | null>(null);\r\n  const [scene, setScene] = React.useState<any | null>(null);\r\n  const [camera3d, setCamera3d] = React.useState<any | null>(null);\r\n  const [renderer3d, setRenderer3d] = React.useState<any | null>(null);\r\n  const controlsRef = React.useRef<any>(null);\r\n  const rafRef = React.useRef<number | null>(null);\r\n  const [overlayEl, setOverlayEl] = React.useState<HTMLDivElement | null>(null);\r\n\r\n  // Lazy-load THREE from CDN to avoid hard dependency for the library\r\n  React.useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        // @ts-ignore - ESM CDN import\r\n  const THREE: any = await import('https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js');\r\n  // Import OrbitControls from the same version; relies on a page-level import map mapping \"three\" to the URL above\r\n  const { OrbitControls }: any = await import('https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js');\r\n        if (!mounted) return;\r\n  setThree({ ...THREE, OrbitControls });\r\n\r\n  // Init scene\r\n  const _scene = new THREE.Scene();\r\n  _scene.background = new THREE.Color(background);\r\n  setScene(_scene);\r\n\r\n        // Camera\r\n        const fov = camera?.fov ?? 50;\r\n        const near = camera?.near ?? 0.1;\r\n        const far = camera?.far ?? 1000;\r\n  const cam = new THREE.PerspectiveCamera(fov, width / height, near, far);\r\n  // Default view tweaked so the +Z (blue) axis projects to the right on screen\r\n  // Old default was [3, 3, 6]; switching X to negative flips the horizontal projection of +Z\r\n  const [cx, cy, cz] = camera?.position ?? [-3, 3, 6];\r\n        cam.position.set(cx, cy, cz);\r\n        const look = camera?.lookAt ?? [0, 0, 0];\r\n        cam.lookAt(...look);\r\n  setCamera3d(cam);\r\n\r\n        // Renderer\r\n  const renderer = new THREE.WebGLRenderer({ antialias: true });\r\n        renderer.setSize(width, height);\r\n        renderer.setPixelRatio(Math.min(2, window.devicePixelRatio || 1));\r\n  setRenderer3d(renderer);\r\n        const container = containerRef.current!;\r\n        container.innerHTML = \"\";\r\n        container.appendChild(renderer.domElement);\r\n\r\n        // Lights (basic)\r\n  const ambient = new THREE.AmbientLight(0xffffff, 0.6);\r\n  _scene.add(ambient);\r\n        const dir = new THREE.DirectionalLight(0xffffff, 0.8);\r\n        dir.position.set(5, 8, 4);\r\n  _scene.add(dir);\r\n\r\n        // Controls\r\n        if (orbitControls) {\r\n          const controls = new OrbitControls(cam, renderer.domElement);\r\n          controls.enableDamping = true;\r\n          controls.dampingFactor = 0.08;\r\n          controlsRef.current = controls;\r\n        }\r\n\r\n        const onResize = () => {\r\n          const w = width;\r\n          const h = height;\r\n          renderer.setSize(w, h);\r\n          cam.aspect = w / h;\r\n          cam.updateProjectionMatrix();\r\n        };\r\n        onResize();\r\n\r\n        const animate = () => {\r\n          rafRef.current = requestAnimationFrame(animate);\r\n          controlsRef.current?.update?.();\r\n          renderer.render(_scene, cam);\r\n        };\r\n        animate();\r\n\r\n      } catch (err) {\r\n        console.error(\"Failed to load THREE:\", err);\r\n      }\r\n    })();\r\n    return () => {\r\n      mounted = false;\r\n      if (rafRef.current) cancelAnimationFrame(rafRef.current);\r\n      try { controlsRef.current?.dispose?.(); } catch {}\r\n      try { renderer3d?.dispose?.(); } catch {}\r\n      if (containerRef.current) containerRef.current.innerHTML = \"\";\r\n    };\r\n  }, [width, height, background, camera?.fov, camera?.near, camera?.far, camera?.position?.[0], camera?.position?.[1], camera?.position?.[2], camera?.lookAt?.[0], camera?.lookAt?.[1], camera?.lookAt?.[2], orbitControls]);\r\n\r\n  const ctxValue = React.useMemo(() => ({\r\n    THREE: three,\r\n    scene: scene,\r\n    camera: camera3d,\r\n    renderer: renderer3d,\r\n    htmlOverlay: overlayEl,\r\n  }), [three, scene, camera3d, renderer3d, overlayEl]);\r\n\r\n  return (\r\n    <div className={className} style={{ position:'relative', width, height, overscrollBehavior:'contain', touchAction:'none', ...style }}>\r\n      <div ref={containerRef} style={{ position:'absolute', inset:0 }} />\r\n      <ThreeContext.Provider value={ctxValue}>\r\n        {children}\r\n      </ThreeContext.Provider>\r\n      <div ref={setOverlayEl} style={{ position:'absolute', inset:0, pointerEvents:'none', fontFamily:'system-ui, Segoe UI, Roboto, sans-serif', fontSize:12, color:'#222' }} />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nexport type ThreeContextType = {\r\n  THREE: any | null;\r\n  scene: any | null;\r\n  camera: any | null;\r\n  renderer: any | null;\r\n  htmlOverlay?: HTMLDivElement | null;\r\n};\r\n\r\nexport const ThreeContext = React.createContext<ThreeContextType>({\r\n  THREE: null,\r\n  scene: null,\r\n  camera: null,\r\n  renderer: null,\r\n  htmlOverlay: null,\r\n});\r\n\r\nexport const useThree = () => React.useContext(ThreeContext);\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Axes3DProps = {\r\n  /** Half-extent of each axis; axes go from -size to +size. */\r\n  size?: number;\r\n  /** Cylinder radius in world units; if not provided or <= 0, draws thin line axes. */\r\n  thickness?: number;\r\n  /** Show arrowheads. */\r\n  arrows?: boolean;\r\n  /** Also draw arrowheads on the negative side. */\r\n  negativeArrows?: boolean;\r\n};\r\n\r\nexport function Axes3D({ size = 2, thickness = 0, arrows = true, negativeArrows = false }: Axes3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  // Render the actual axis meshes in an effect\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const target = parent ?? scene;\r\n    // Thin axes using lines from -size to +size\r\n    if (!thickness || thickness <= 0) {\r\n      const group = new THREE.Group();\r\n      const mkLine = (axis: 'x'|'y'|'z', color: number) => {\r\n        const mat = new THREE.LineBasicMaterial({ color });\r\n        const pos = new Float32Array([\r\n          axis==='x' ? -size : 0, axis==='y' ? -size : 0, axis==='z' ? -size : 0,\r\n          axis==='x' ?  size : 0, axis==='y' ?  size : 0, axis==='z' ?  size : 0,\r\n        ]);\r\n        const geo = new THREE.BufferGeometry();\r\n        geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));\r\n        const line = new THREE.Line(geo, mat);\r\n        group.add(line);\r\n\r\n        // Arrowheads (positive and optionally negative)\r\n        const cones: any[] = [];\r\n        if (arrows) {\r\n          const h = Math.max(size * 0.24, 0.12);\r\n          const r = Math.max(size * 0.06, 0.04);\r\n          const coneGeo = new THREE.ConeGeometry(r, h, 16);\r\n          const coneMat = new THREE.MeshStandardMaterial({ color });\r\n          const coneP = new THREE.Mesh(coneGeo, coneMat);\r\n          if (axis==='x') { coneP.rotation.z = -Math.PI/2; coneP.position.set(size,0,0); }\r\n          if (axis==='y') { /* default +Y */ coneP.position.set(0,size,0); }\r\n          if (axis==='z') { coneP.rotation.x = Math.PI/2; coneP.position.set(0,0,size); }\r\n          group.add(coneP); cones.push(coneP);\r\n          if (negativeArrows) {\r\n            const coneN = new THREE.Mesh(coneGeo.clone(), coneMat);\r\n            if (axis==='x') { coneN.rotation.z = Math.PI/2; coneN.position.set(-size,0,0); }\r\n            if (axis==='y') { coneN.rotation.x = Math.PI; coneN.position.set(0,-size,0); }\r\n            if (axis==='z') { coneN.rotation.x = -Math.PI/2; coneN.position.set(0,0,-size); }\r\n            group.add(coneN); cones.push(coneN);\r\n          }\r\n        }\r\n\r\n        return () => {\r\n          geo.dispose();\r\n          mat.dispose();\r\n          cones.forEach(c => { c.geometry.dispose?.(); c.material.dispose?.(); });\r\n        };\r\n      };\r\n\r\n      const cleanups: Array<() => void> = [];\r\n      target.add(group);\r\n      cleanups.push(mkLine('x', 0xff0000));\r\n      cleanups.push(mkLine('y', 0x00ff00));\r\n      cleanups.push(mkLine('z', 0x0000ff));\r\n      return () => {\r\n        target.remove(group);\r\n        cleanups.forEach(fn => { try { fn(); } catch {} });\r\n      };\r\n    }\r\n\r\n    // Thick axes using cylinders from -size to +size (and optional cone arrowheads)\r\n    const group = new THREE.Group();\r\n\r\n    const mkAxis = (axis: 'x'|'y'|'z', color: number) => {\r\n      const len = size * 2;\r\n      const cylGeo = new THREE.CylinderGeometry(thickness, thickness, len, 16);\r\n      const mat = new THREE.MeshStandardMaterial({ color });\r\n      const cyl = new THREE.Mesh(cylGeo, mat);\r\n      if (axis === 'x') {\r\n        cyl.rotation.z = Math.PI / 2;\r\n      } else if (axis === 'y') {\r\n        // along Y by default\r\n      } else { // 'z'\r\n        cyl.rotation.x = Math.PI / 2;\r\n      }\r\n      group.add(cyl);\r\n\r\n      const cones: any[] = [];\r\n      if (arrows) {\r\n        const h = Math.max(size * 0.24, thickness * 6);\r\n        const r = Math.max(thickness * 2, size * 0.06);\r\n        const coneGeo = new THREE.ConeGeometry(r, h, 16);\r\n        const coneMat = new THREE.MeshStandardMaterial({ color });\r\n        const coneP = new THREE.Mesh(coneGeo, coneMat);\r\n        if (axis === 'x') { coneP.rotation.z = -Math.PI/2; coneP.position.set(size,0,0); }\r\n        if (axis === 'y') { coneP.position.set(0,size,0); }\r\n        if (axis === 'z') { coneP.rotation.x = Math.PI/2; coneP.position.set(0,0,size); }\r\n        group.add(coneP); cones.push(coneP);\r\n        if (negativeArrows) {\r\n          const coneN = new THREE.Mesh(coneGeo.clone(), coneMat);\r\n          if (axis === 'x') { coneN.rotation.z = Math.PI/2; coneN.position.set(-size,0,0); }\r\n          if (axis === 'y') { coneN.rotation.x = Math.PI; coneN.position.set(0,-size,0); }\r\n          if (axis === 'z') { coneN.rotation.x = -Math.PI/2; coneN.position.set(0,0,-size); }\r\n          group.add(coneN); cones.push(coneN);\r\n        }\r\n      }\r\n\r\n      return () => {\r\n        cylGeo.dispose();\r\n        mat.dispose();\r\n        cones.forEach(co => { co.geometry.dispose?.(); co.material.dispose?.(); });\r\n      };\r\n    };\r\n\r\n    const cleanups: Array<() => void> = [];\r\n    target.add(group);\r\n    cleanups.push(mkAxis('x', 0xff0000));\r\n    cleanups.push(mkAxis('y', 0x00ff00));\r\n    cleanups.push(mkAxis('z', 0x0000ff));\r\n\r\n    return () => {\r\n      target.remove(group);\r\n      cleanups.forEach(fn => { try { fn(); } catch {} });\r\n    };\r\n  }, [THREE, scene, parent, size, thickness, arrows, negativeArrows]);\r\n\r\n  // Also allow rendering customizable tip labels via Label3D by composing this component with it\r\n  return null;\r\n}\r\n","import React from \"react\";\r\n\r\n// We intentionally avoid importing 'three' types to keep the library runtime-agnostic.\r\nexport const ThreeParentContext = React.createContext<any | null>(null);\r\nexport const useThreeParent = () => React.useContext(ThreeParentContext);\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Grid3DProps = {\r\n  size?: number; // total size\r\n  divisions?: number;\r\n  color1?: number; // hex\r\n  color2?: number; // hex\r\n};\r\n\r\nexport function Grid3D({ size = 10, divisions = 10, color1 = 0xcccccc, color2 = 0xe5e7eb }: Grid3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const grid = new THREE.GridHelper(size, divisions, color1, color2);\r\n    (parent ?? scene).add(grid);\r\n    return () => { (parent ?? scene).remove(grid); };\r\n  }, [THREE, scene, parent, size, divisions, color1, color2]);\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Box3DProps = {\r\n  size?: [number, number, number];\r\n  position?: [number, number, number];\r\n  color?: string | number;\r\n  wireframe?: boolean;\r\n};\r\n\r\nexport function Box3D({ size = [1,1,1], position = [0,0,0], color = 0xef4444, wireframe = false }: Box3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = new THREE.BoxGeometry(size[0], size[1], size[2]);\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    mesh.position.set(...position);\r\n    (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => {\r\n      (parent ?? scene).remove(mesh);\r\n      geo.dispose();\r\n      mat.dispose();\r\n    };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current) return;\r\n    meshRef.current.position.set(...position);\r\n  }, [position?.[0], position?.[1], position?.[2]]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    // Update geometry by reassigning (simple approach)\r\n    const old = meshRef.current.geometry;\r\n    const geo = new THREE.BoxGeometry(size[0], size[1], size[2]);\r\n    meshRef.current.geometry = geo;\r\n    old?.dispose?.();\r\n  }, [size?.[0], size?.[1], size?.[2]]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    meshRef.current.material.color = new THREE.Color(color as any);\r\n    meshRef.current.material.wireframe = wireframe;\r\n  }, [color, wireframe, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Sphere3DProps = {\r\n  radius?: number;\r\n  widthSegments?: number;\r\n  heightSegments?: number;\r\n  position?: [number, number, number];\r\n  color?: string | number;\r\n  wireframe?: boolean;\r\n};\r\n\r\nexport function Sphere3D({ radius = 0.6, widthSegments = 32, heightSegments = 16, position = [0,0,0], color = 0x10b981, wireframe = false }: Sphere3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = new THREE.SphereGeometry(radius, widthSegments, heightSegments);\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    mesh.position.set(...position);\r\n    (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => {\r\n      (parent ?? scene).remove(mesh);\r\n      geo.dispose();\r\n      mat.dispose();\r\n    };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current) return;\r\n    meshRef.current.position.set(...position);\r\n  }, [position?.[0], position?.[1], position?.[2]]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    const old = meshRef.current.geometry;\r\n    const geo = new THREE.SphereGeometry(radius, widthSegments, heightSegments);\r\n    meshRef.current.geometry = geo;\r\n    old?.dispose?.();\r\n  }, [radius, widthSegments, heightSegments]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    meshRef.current.material.color = new THREE.Color(color as any);\r\n    meshRef.current.material.wireframe = wireframe;\r\n  }, [color, wireframe, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\n\r\nexport type Label3DProps = {\r\n  position: [number, number, number];\r\n  children: React.ReactNode;\r\n  align?: 'left' | 'center' | 'right';\r\n  vAlign?: 'top' | 'middle' | 'bottom';\r\n  dx?: number; // px offset x\r\n  dy?: number; // px offset y\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n};\r\n\r\nexport function Label3D({ position, children, align = 'left', vAlign = 'top', dx = 0, dy = 0, className, style }: Label3DProps) {\r\n  const { THREE, camera, renderer, htmlOverlay } = useThree();\r\n  const elRef = React.useRef<HTMLDivElement | null>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !camera || !renderer || !htmlOverlay || !elRef.current) return;\r\n    const el = elRef.current;\r\n    const v = new THREE.Vector3();\r\n    let stopped = false;\r\n    const update = () => {\r\n      if (stopped) return;\r\n      try {\r\n        v.set(position[0], position[1], position[2]);\r\n        v.project(camera);\r\n        const x = (v.x * 0.5 + 0.5) * renderer.domElement.clientWidth;\r\n        const y = ( -v.y * 0.5 + 0.5) * renderer.domElement.clientHeight;\r\n        const ax = align === 'center' ? -50 : align === 'right' ? -100 : 0;\r\n        const ay = vAlign === 'middle' ? -50 : vAlign === 'bottom' ? -100 : 0;\r\n        el.style.transform = `translate(${Math.round(x+dx)}px, ${Math.round(y+dy)}px) translate(${ax}%, ${ay}%)`;\r\n        el.style.display = v.z < 1 ? 'block' : 'none';\r\n      } catch {}\r\n      requestAnimationFrame(update);\r\n    };\r\n    const id = requestAnimationFrame(update);\r\n    return () => { stopped = true; cancelAnimationFrame(id); };\r\n  }, [THREE, camera, renderer, htmlOverlay, position?.[0], position?.[1], position?.[2], align, vAlign, dx, dy]);\r\n\r\n  if (!htmlOverlay) return null;\r\n  return (\r\n    <div ref={elRef} className={className} style={{ position:'absolute', pointerEvents:'none', ...style }}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\n\r\nexport type Legend3DItem = {\r\n  label: React.ReactNode;\r\n  color?: string;\r\n  marker?: React.ReactNode;\r\n};\r\n\r\nexport type Legend3DProps = {\r\n  items: Legend3DItem[];\r\n  position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\r\n  bg?: string;\r\n  padding?: number;\r\n};\r\n\r\nexport function Legend3D({ items, position='top-right', bg='rgba(255,255,255,0.92)', padding=8 }: Legend3DProps) {\r\n  const { htmlOverlay } = useThree();\r\n  if (!htmlOverlay) return null;\r\n  const isTR = position === 'top-right';\r\n  const isBR = position === 'bottom-right';\r\n  const x = isTR || isBR ? 'right' : 'left';\r\n  const y = position.startsWith('top') ? 'top' : 'bottom';\r\n  const style: React.CSSProperties = {\r\n    position:'absolute',\r\n    [x]: padding,\r\n    [y]: padding,\r\n    transform: undefined,\r\n    background: bg,\r\n    border:'1px solid #e5e7eb',\r\n    borderRadius:6,\r\n    padding:8,\r\n    boxShadow:'0 1px 3px rgba(0,0,0,0.1)',\r\n    pointerEvents:'none',\r\n    fontSize:12,\r\n  } as any;\r\n  return (\r\n    <div style={style}>\r\n      {items.map((it, i)=> (\r\n        <div key={i} style={{ display:'flex', alignItems:'center', gap:8, margin:'4px 0', whiteSpace:'nowrap' }}>\r\n          {it.marker ?? <svg width={18} height={10} style={{ flex:'0 0 auto' }}>\r\n            <line x1={0} y1={5} x2={18} y2={5} stroke={it.color ?? '#111'} strokeWidth={2} />\r\n          </svg>}\r\n          <div>{it.label}</div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Torus3DProps = {\r\n  radius?: number; // major radius\r\n  tube?: number;   // tube radius\r\n  radialSegments?: number;\r\n  tubularSegments?: number;\r\n  arc?: number;\r\n  position?: [number, number, number];\r\n  rotation?: [number, number, number];\r\n  color?: string | number;\r\n  wireframe?: boolean;\r\n};\r\n\r\nexport function Torus3D({ radius=1, tube=0.3, radialSegments=16, tubularSegments=48, arc=Math.PI*2, position=[0,0,0], rotation=[0,0,0], color=0x9333ea, wireframe=false }: Torus3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = new THREE.TorusGeometry(radius, tube, radialSegments, tubularSegments, arc);\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    mesh.position.set(...position);\r\n    mesh.rotation.set(...rotation);\r\n    (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => {\r\n      (parent ?? scene).remove(mesh);\r\n      geo.dispose();\r\n      mat.dispose();\r\n    };\r\n  }, [THREE, scene]);\r\n\r\n  React.useEffect(() => { meshRef.current?.position.set(...position); }, [position?.[0], position?.[1], position?.[2]]);\r\n\r\n  React.useEffect(() => { meshRef.current?.rotation.set(...rotation); }, [rotation?.[0], rotation?.[1], rotation?.[2]]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    const old = meshRef.current.geometry;\r\n    const geo = new THREE.TorusGeometry(radius, tube, radialSegments, tubularSegments, arc);\r\n    meshRef.current.geometry = geo; old?.dispose?.();\r\n  }, [radius, tube, radialSegments, tubularSegments, arc]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    meshRef.current.material.color = new THREE.Color(color as any);\r\n    meshRef.current.material.wireframe = wireframe;\r\n  }, [color, wireframe, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Cylinder3DProps = {\r\n  radiusTop?: number;\r\n  radiusBottom?: number;\r\n  height?: number;\r\n  radialSegments?: number;\r\n  openEnded?: boolean;\r\n  position?: [number, number, number];\r\n  rotation?: [number, number, number]; // Euler in radians\r\n  color?: string | number;\r\n  wireframe?: boolean;\r\n};\r\n\r\nexport function Cylinder3D({ radiusTop=0.4, radiusBottom=0.4, height=1.2, radialSegments=32, openEnded=false, position=[0,0,0], rotation=[0,0,0], color=0x64748b, wireframe=false }: Cylinder3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = new THREE.CylinderGeometry(radiusTop, radiusBottom, height, radialSegments, 1, openEnded);\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    mesh.position.set(...position);\r\n    mesh.rotation.set(...rotation);\r\n  (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => { (parent ?? scene).remove(mesh); geo.dispose(); mat.dispose(); };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => { meshRef.current?.position.set(...position); }, [position?.[0], position?.[1], position?.[2]]);\r\n  React.useEffect(() => { meshRef.current?.rotation.set(...rotation); }, [rotation?.[0], rotation?.[1], rotation?.[2]]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    const old = meshRef.current.geometry;\r\n    meshRef.current.geometry = new THREE.CylinderGeometry(radiusTop, radiusBottom, height, radialSegments, 1, openEnded);\r\n    old?.dispose?.();\r\n  }, [radiusTop, radiusBottom, height, radialSegments, openEnded]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    meshRef.current.material.color = new THREE.Color(color as any);\r\n    meshRef.current.material.wireframe = wireframe;\r\n  }, [color, wireframe, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Cone3DProps = {\r\n  radius?: number;\r\n  height?: number;\r\n  radialSegments?: number;\r\n  openEnded?: boolean;\r\n  position?: [number, number, number];\r\n  rotation?: [number, number, number];\r\n  color?: string | number;\r\n  wireframe?: boolean;\r\n};\r\n\r\nexport function Cone3D({ radius=0.45, height=1.2, radialSegments=32, openEnded=false, position=[0,0,0], rotation=[0,0,0], color=0xf59e0b, wireframe=false }: Cone3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = new THREE.ConeGeometry(radius, height, radialSegments, 1, openEnded);\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    mesh.position.set(...position);\r\n    mesh.rotation.set(...rotation);\r\n  (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => { (parent ?? scene).remove(mesh); geo.dispose(); mat.dispose(); };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => { meshRef.current?.position.set(...position); }, [position?.[0], position?.[1], position?.[2]]);\r\n  React.useEffect(() => { meshRef.current?.rotation.set(...rotation); }, [rotation?.[0], rotation?.[1], rotation?.[2]]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    const old = meshRef.current.geometry;\r\n    meshRef.current.geometry = new THREE.ConeGeometry(radius, height, radialSegments, 1, openEnded);\r\n    old?.dispose?.();\r\n  }, [radius, height, radialSegments, openEnded]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    meshRef.current.material.color = new THREE.Color(color as any);\r\n    meshRef.current.material.wireframe = wireframe;\r\n  }, [color, wireframe, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Surface3DProps = {\r\n  xRange: [number, number];\r\n  yRange: [number, number];\r\n  xSegments?: number;\r\n  ySegments?: number;\r\n  f: (x:number, y:number) => number; // z=f(x,y)\r\n  color?: string | number; // base color if no colorMap\r\n  colorMap?: (x:number, y:number, z:number) => string | number; // per-vertex color\r\n  wireframe?: boolean;\r\n  doubleSided?: boolean;\r\n};\r\n\r\nexport function Surface3D({ xRange, yRange, xSegments=64, ySegments=48, f, color=0x22c55e, colorMap, wireframe=false, doubleSided=true }: Surface3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  const buildGeometry = React.useCallback(() => {\r\n    if (!THREE) return null;\r\n    const nx = Math.max(1, xSegments);\r\n    const ny = Math.max(1, ySegments);\r\n    const nCols = nx + 1;\r\n    const nRows = ny + 1;\r\n    const positions = new Float32Array(nCols * nRows * 3);\r\n    const colors = colorMap ? new Float32Array(nCols * nRows * 3) : null;\r\n\r\n    let idx = 0, cidx = 0;\r\n    for (let j=0; j<=ny; j++) {\r\n      const v = j / ny;\r\n      const y = yRange[0] + v * (yRange[1] - yRange[0]);\r\n      for (let i=0; i<=nx; i++) {\r\n        const u = i / nx;\r\n        const x = xRange[0] + u * (xRange[1] - xRange[0]);\r\n        const z = f(x, y);\r\n        positions[idx++] = x;\r\n        positions[idx++] = z;\r\n        positions[idx++] = y;\r\n        if (colors) {\r\n          const col = new THREE.Color(colorMap!(x, y, z) as any);\r\n          colors[cidx++] = col.r;\r\n          colors[cidx++] = col.g;\r\n          colors[cidx++] = col.b;\r\n        }\r\n      }\r\n    }\r\n\r\n    const indices: number[] = [];\r\n    for (let j=0; j<ny; j++) {\r\n      for (let i=0; i<nx; i++) {\r\n        const a = i + j * (nx+1);\r\n        const b = (i+1) + j * (nx+1);\r\n        const c = (i+1) + (j+1) * (nx+1);\r\n        const d = i + (j+1) * (nx+1);\r\n        indices.push(a, b, d, b, c, d);\r\n      }\r\n    }\r\n\r\n    const geo = new THREE.BufferGeometry();\r\n    geo.setAttribute('position', new THREE.BufferAttribute(positions, 3));\r\n    geo.setIndex(indices);\r\n    if (colors) geo.setAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n    geo.computeVertexNormals();\r\n    return geo;\r\n  }, [THREE, xRange?.[0], xRange?.[1], yRange?.[0], yRange?.[1], xSegments, ySegments, f, colorMap]);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = buildGeometry(); if (!geo) return;\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe, vertexColors: !!colorMap, side: doubleSided ? THREE.DoubleSide : THREE.FrontSide });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => { (parent ?? scene).remove(mesh); geo.dispose(); mat.dispose(); };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current) return;\r\n    const old = meshRef.current.geometry; const geo = buildGeometry(); if (!geo) return;\r\n    meshRef.current.geometry = geo; old?.dispose?.();\r\n  }, [buildGeometry]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    const mat = meshRef.current.material;\r\n    mat.color = new THREE.Color(color as any);\r\n    mat.wireframe = wireframe;\r\n    mat.vertexColors = !!colorMap;\r\n    mat.side = doubleSided ? THREE.DoubleSide : THREE.FrontSide;\r\n    mat.needsUpdate = true;\r\n  }, [color, wireframe, colorMap, doubleSided, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type ParametricSurface3DProps = {\r\n  uRange: [number, number];\r\n  vRange: [number, number];\r\n  uSegments?: number;\r\n  vSegments?: number;\r\n  f: (u:number, v:number) => [number, number, number];\r\n  color?: string | number;\r\n  colorMap?: (u:number, v:number, x:number, y:number, z:number) => string | number;\r\n  wireframe?: boolean;\r\n  doubleSided?: boolean;\r\n};\r\n\r\nexport function ParametricSurface3D({ uRange, vRange, uSegments=80, vSegments=30, f, color=0x0ea5e9, colorMap, wireframe=false, doubleSided=true }: ParametricSurface3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const meshRef = React.useRef<any>(null);\r\n\r\n  const buildGeometry = React.useCallback(() => {\r\n    if (!THREE) return null;\r\n    const nu = Math.max(1, uSegments);\r\n    const nv = Math.max(1, vSegments);\r\n    const positions = new Float32Array((nu+1)*(nv+1)*3);\r\n    const colors = colorMap ? new Float32Array((nu+1)*(nv+1)*3) : null;\r\n    let idx = 0, cidx = 0;\r\n    for (let j=0; j<=nv; j++) {\r\n      const v = vRange[0] + (j/nv)*(vRange[1]-vRange[0]);\r\n      for (let i=0; i<=nu; i++) {\r\n        const u = uRange[0] + (i/nu)*(uRange[1]-uRange[0]);\r\n        const [x,y,z] = f(u,v);\r\n        positions[idx++] = x; positions[idx++] = y; positions[idx++] = z;\r\n        if (colors) {\r\n          const col = new THREE.Color(colorMap!(u,v,x,y,z) as any);\r\n          colors[cidx++] = col.r; colors[cidx++] = col.g; colors[cidx++] = col.b;\r\n        }\r\n      }\r\n    }\r\n    const indices: number[] = [];\r\n    for (let j=0; j<nv; j++) {\r\n      for (let i=0; i<nu; i++) {\r\n        const a = i + j*(nu+1);\r\n        const b = (i+1) + j*(nu+1);\r\n        const c = (i+1) + (j+1)*(nu+1);\r\n        const d = i + (j+1)*(nu+1);\r\n        indices.push(a,b,d, b,c,d);\r\n      }\r\n    }\r\n    const geo = new THREE.BufferGeometry();\r\n    geo.setAttribute('position', new THREE.BufferAttribute(positions,3));\r\n    if (colors) geo.setAttribute('color', new THREE.BufferAttribute(colors,3));\r\n    geo.setIndex(indices);\r\n    geo.computeVertexNormals();\r\n    return geo;\r\n  }, [THREE, uRange?.[0], uRange?.[1], vRange?.[0], vRange?.[1], uSegments, vSegments, f, colorMap]);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const geo = buildGeometry(); if (!geo) return;\r\n    const mat = new THREE.MeshStandardMaterial({ color, wireframe, vertexColors: !!colorMap, side: doubleSided ? THREE.DoubleSide : THREE.FrontSide });\r\n    const mesh = new THREE.Mesh(geo, mat);\r\n    (parent ?? scene).add(mesh);\r\n    meshRef.current = mesh;\r\n    return () => { (parent ?? scene).remove(mesh); geo.dispose(); mat.dispose(); };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current) return;\r\n    const old = meshRef.current.geometry; const geo = buildGeometry(); if (!geo) return;\r\n    meshRef.current.geometry = geo; old?.dispose?.();\r\n  }, [buildGeometry]);\r\n\r\n  React.useEffect(() => {\r\n    if (!meshRef.current || !THREE) return;\r\n    const mat = meshRef.current.material;\r\n    mat.color = new THREE.Color(color as any);\r\n    mat.wireframe = wireframe;\r\n    mat.vertexColors = !!colorMap;\r\n    mat.side = doubleSided ? THREE.DoubleSide : THREE.FrontSide;\r\n    mat.needsUpdate = true;\r\n  }, [color, wireframe, colorMap, doubleSided, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { useThreeParent } from \"./threeParent\";\r\n\r\nexport type Scatter3DProps = {\r\n  points: Array<[number, number, number]>;\r\n  color?: string | number; // base color if no per-point color\r\n  colors?: Array<string | number>; // per-point colors (overrides colorMap)\r\n  colorMap?: (x:number, y:number, z:number, i:number) => string | number; // used when colors not provided\r\n  size?: number; // in pixels\r\n  opacity?: number;\r\n};\r\n\r\nexport function Scatter3D({ points, color = 0x3b82f6, colors, colorMap, size = 6, opacity = 1 }: Scatter3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const ptsRef = React.useRef<any>(null);\r\n\r\n  const buildGeometry = React.useCallback(() => {\r\n    if (!THREE) return null;\r\n    const n = points?.length ?? 0;\r\n    const pos = new Float32Array(n * 3);\r\n    const useVertexColors = !!(colors?.length) || !!colorMap;\r\n    const col = useVertexColors ? new Float32Array(n * 3) : null;\r\n    for (let i=0; i<n; i++) {\r\n      const [x,y,z] = points[i];\r\n      const j = i*3;\r\n      pos[j] = x; pos[j+1] = y; pos[j+2] = z;\r\n      if (col) {\r\n        const c = new THREE.Color(\r\n          (colors && colors[i] !== undefined) ? (colors[i] as any) : (colorMap ? (colorMap(x,y,z,i) as any) : color as any)\r\n        );\r\n        col[j] = c.r; col[j+1] = c.g; col[j+2] = c.b;\r\n      }\r\n    }\r\n    const geo = new THREE.BufferGeometry();\r\n    geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));\r\n    if (col) geo.setAttribute('color', new THREE.BufferAttribute(col, 3));\r\n    return { geo, vertexColors: !!col };\r\n  }, [THREE, points, colors, colorMap, color]);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const built = buildGeometry(); if (!built) return;\r\n    const mat = new THREE.PointsMaterial({\r\n      color: (colors?.length || colorMap) ? 0xffffff : (color as any),\r\n      vertexColors: !!(colors?.length || colorMap),\r\n      size: size,\r\n      sizeAttenuation: false,\r\n      opacity,\r\n      transparent: opacity < 1\r\n    });\r\n    const pointsObj = new THREE.Points(built.geo, mat);\r\n    (parent ?? scene).add(pointsObj);\r\n    ptsRef.current = pointsObj;\r\n    return () => { (parent ?? scene).remove(pointsObj); built.geo.dispose(); mat.dispose(); };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => {\r\n    const obj = ptsRef.current; if (!obj) return;\r\n    const old = obj.geometry; const built = buildGeometry(); if (!built) return;\r\n    obj.geometry = built.geo; obj.material.vertexColors = built.vertexColors;\r\n    old?.dispose?.();\r\n  }, [buildGeometry]);\r\n\r\n  React.useEffect(() => {\r\n    const obj = ptsRef.current; if (!obj || !THREE) return;\r\n    obj.material.size = size;\r\n    obj.material.opacity = opacity;\r\n    obj.material.transparent = opacity < 1;\r\n    if (!(colors?.length || colorMap)) {\r\n      obj.material.color = new THREE.Color(color as any);\r\n    }\r\n    obj.material.needsUpdate = true;\r\n  }, [size, opacity, color, colors?.length, !!colorMap, THREE]);\r\n\r\n  return null;\r\n}\r\n","import React from \"react\";\r\n\r\nexport type UseAnimationOptions = {\r\n  autoplay?: boolean; // start playing on mount\r\n  speed?: number;     // time scale factor (1 = realtime seconds)\r\n  duration?: number;  // optional looping duration in seconds\r\n  loop?: boolean;     // if duration provided, wrap t modulo duration\r\n  onTick?: (t:number, dt:number)=>void; // optional side-effect callback each frame\r\n};\r\n\r\nexport type AnimationApi = {\r\n  t: number;        // elapsed time in seconds (scaled)\r\n  dt: number;       // last frame dt in seconds (scaled)\r\n  playing: boolean;\r\n  speed: number;\r\n  play: ()=>void;\r\n  stop: ()=>void;\r\n  toggle: ()=>void;\r\n  reset: ()=>void;     // set t=0\r\n  setTime: (t:number)=>void;\r\n  setSpeed: (s:number)=>void;\r\n};\r\n\r\nexport function useAnimation(opts: UseAnimationOptions = {}): AnimationApi {\r\n  const { autoplay = false, speed: initSpeed = 1, duration, loop = Boolean(opts.duration), onTick } = opts;\r\n  const [t, setT] = React.useState(0);\r\n  const [dt, setDt] = React.useState(0);\r\n  // Start stopped; if autoplay, we'll call play() on mount\r\n  const [playing, setPlaying] = React.useState<boolean>(false);\r\n  const speedRef = React.useRef(initSpeed);\r\n  const rafRef = React.useRef<number | null>(null);\r\n  const lastTsRef = React.useRef<number | null>(null);\r\n  const tRef = React.useRef(0);\r\n\r\n  // Keep refs in sync with state\r\n  React.useEffect(() => { tRef.current = t; }, [t]);\r\n\r\n  const step = React.useCallback((now: number) => {\r\n    const last = lastTsRef.current ?? now;\r\n    const rawDt = (now - last) / 1000;\r\n    lastTsRef.current = now;\r\n    const scaledDt = rawDt * speedRef.current;\r\n    let newT = tRef.current + scaledDt;\r\n    if (duration && loop) {\r\n      const dur = Math.max(1e-9, duration);\r\n      newT = ((newT % dur) + dur) % dur;\r\n    }\r\n    tRef.current = newT;\r\n    setT(newT);\r\n    setDt(scaledDt);\r\n    onTick?.(newT, scaledDt);\r\n    rafRef.current = requestAnimationFrame(step);\r\n  }, [duration, loop, onTick]);\r\n\r\n  const play = React.useCallback(() => {\r\n    // If RAF is already running, do nothing.\r\n    if (rafRef.current != null) return;\r\n    setPlaying(true);\r\n    lastTsRef.current = null;\r\n    rafRef.current = requestAnimationFrame(step);\r\n  }, [step]);\r\n\r\n  const stop = React.useCallback(() => {\r\n    setPlaying(false);\r\n    if (rafRef.current) cancelAnimationFrame(rafRef.current);\r\n    rafRef.current = null;\r\n    lastTsRef.current = null;\r\n  }, []);\r\n\r\n  const toggle = React.useCallback(() => {\r\n    if (rafRef.current != null) {\r\n      stop();\r\n    } else {\r\n      play();\r\n    }\r\n  }, [play, stop]);\r\n\r\n  const reset = React.useCallback(() => setT(0), []);\r\n  const setTime = React.useCallback((time: number) => { tRef.current = time; setT(time); }, []);\r\n  const setSpeed = React.useCallback((s: number) => { speedRef.current = s; }, []);\r\n\r\n  // Auto-start/stop lifecycle\r\n  React.useEffect(() => {\r\n    if (autoplay) {\r\n      play();\r\n    }\r\n    return () => {\r\n      if (rafRef.current) cancelAnimationFrame(rafRef.current);\r\n    };\r\n  }, [autoplay, play]);\r\n\r\n  return { t, dt, playing, speed: speedRef.current, play, stop, toggle, reset, setTime, setSpeed };\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { ThreeParentContext, useThreeParent } from \"./threeParent\";\r\n\r\nexport type Group3DProps = {\r\n  children?: React.ReactNode;\r\n  position?: [number, number, number];\r\n  rotation?: [number, number, number];\r\n  scale?: [number, number, number];\r\n};\r\n\r\nexport function Group3D({ children, position=[0,0,0], rotation=[0,0,0], scale=[1,1,1] }: Group3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const groupRef = React.useRef<any>(null);\r\n  const [ready, setReady] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const g = new THREE.Group();\r\n    g.position.set(...position);\r\n    g.rotation.set(...rotation);\r\n    g.scale.set(...scale);\r\n    (parent ?? scene).add(g);\r\n    groupRef.current = g;\r\n    // trigger a re-render so children mount under the created group\r\n    setReady(true);\r\n    return () => { (parent ?? scene).remove(g); };\r\n  }, [THREE, scene, parent]);\r\n\r\n  React.useEffect(() => { groupRef.current?.position.set(...position); }, [position?.[0], position?.[1], position?.[2]]);\r\n  React.useEffect(() => { groupRef.current?.rotation.set(...rotation); }, [rotation?.[0], rotation?.[1], rotation?.[2]]);\r\n  React.useEffect(() => { groupRef.current?.scale.set(...scale); }, [scale?.[0], scale?.[1], scale?.[2]]);\r\n\r\n  if (!groupRef.current || !ready) return null;\r\n  return (\r\n    <ThreeParentContext.Provider value={groupRef.current}>\r\n      {children}\r\n    </ThreeParentContext.Provider>\r\n  );\r\n}\r\n","export type EasingName =\r\n  | \"linear\"\r\n  | \"easeInQuad\"\r\n  | \"easeOutQuad\"\r\n  | \"easeInOutSine\"\r\n  | \"easeInOutCubic\";\r\n\r\nexport type EasingFn = (t: number) => number;\r\n\r\nexport const easing: Record<EasingName, EasingFn> = {\r\n  linear: (t) => t,\r\n  easeInQuad: (t) => t * t,\r\n  easeOutQuad: (t) => t * (2 - t),\r\n  easeInOutSine: (t) => 0.5 - 0.5 * Math.cos(Math.PI * t),\r\n  easeInOutCubic: (t) => (t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2),\r\n};\r\n\r\nexport function getEasing(fn?: EasingName | EasingFn): EasingFn {\r\n  if (!fn) return easing.linear;\r\n  if (typeof fn === \"function\") return fn;\r\n  return easing[fn] ?? easing.linear;\r\n}\r\n","import { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { EasingFn, EasingName, getEasing } from \"./easing\";\r\n\r\nexport interface UseTweenOptions {\r\n  duration?: number; // ms\r\n  delay?: number; // ms\r\n  easing?: EasingName | EasingFn;\r\n  autoplay?: boolean;\r\n  loop?: boolean;\r\n  yoyo?: boolean;\r\n  onUpdate?: (t: number) => void; // eased t\r\n  onComplete?: () => void;\r\n}\r\n\r\nexport interface UseTweenApi {\r\n  t: number; // eased progress 0..1\r\n  isPlaying: boolean;\r\n  play: () => void;\r\n  pause: () => void;\r\n  reset: () => void; // reset to start (direction-respecting)\r\n  reverse: () => void; // flip direction\r\n}\r\n\r\nexport function useTween(options: UseTweenOptions = {}): UseTweenApi {\r\n  const {\r\n    duration = 1000,\r\n    delay = 0,\r\n    easing: easingIn = \"linear\",\r\n    autoplay = false,\r\n    loop = false,\r\n    yoyo = false,\r\n    onUpdate,\r\n    onComplete,\r\n  } = options;\r\n\r\n  const ease = getEasing(easingIn);\r\n  const rafRef = useRef<number | null>(null);\r\n  const intervalRef = useRef<number | null>(null);\r\n  const startTimeRef = useRef<number | null>(null);\r\n  const delayDoneRef = useRef(false);\r\n  const dirRef = useRef<1 | -1>(1); // 1 forward, -1 backward\r\n  const rawRef = useRef(0); // 0..1 raw progress\r\n  const [t, setT] = useState(0);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n\r\n  const step = useCallback(\r\n    (now: number) => {\r\n      // Delay handling\r\n      if (!delayDoneRef.current) {\r\n        if (startTimeRef.current === null) startTimeRef.current = now;\r\n        if (now - startTimeRef.current < delay) {\r\n          rafRef.current = requestAnimationFrame(step);\r\n          return;\r\n        }\r\n        delayDoneRef.current = true;\r\n        startTimeRef.current = now; // reset for active phase\r\n      }\r\n\r\n      const elapsed = now - (startTimeRef.current ?? now);\r\n      let raw = Math.min(Math.max(elapsed / duration, 0), 1);\r\n\r\n      if (dirRef.current < 0) {\r\n        raw = 1 - raw;\r\n      }\r\n      rawRef.current = raw;\r\n\r\n      const eased = ease(raw);\r\n      setT(eased);\r\n      onUpdate?.(eased);\r\n\r\n      const finished = elapsed >= duration;\r\n      if (!finished) {\r\n        rafRef.current = requestAnimationFrame(step);\r\n        return;\r\n      }\r\n\r\n      if (loop) {\r\n        // Loop logic (with optional yoyo flip)\r\n        if (yoyo) dirRef.current = dirRef.current === 1 ? -1 : 1;\r\n        startTimeRef.current = now;\r\n        rafRef.current = requestAnimationFrame(step);\r\n        return;\r\n      }\r\n\r\n      // Complete\r\n      setIsPlaying(false);\r\n      rafRef.current = null;\r\n      onComplete?.();\r\n    },\r\n    [delay, duration, ease, loop, onComplete, onUpdate, yoyo]\r\n  );\r\n\r\n  const play = useCallback(() => {\r\n    if (rafRef.current != null) return; // already running\r\n    setIsPlaying(true);\r\n    startTimeRef.current = null;\r\n    delayDoneRef.current = false;\r\n    rafRef.current = requestAnimationFrame(step);\r\n    // Fallback driver in case RAF is throttled or not firing in this environment\r\n    if (intervalRef.current == null && typeof window !== 'undefined') {\r\n      intervalRef.current = window.setInterval(() => {\r\n        try {\r\n          // Prefer high-res time\r\n          const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n          step(now as number);\r\n        } catch {/* noop */}\r\n      }, 16);\r\n    }\r\n  }, [step]);\r\n\r\n  const pause = useCallback(() => {\r\n    if (rafRef.current != null) {\r\n      cancelAnimationFrame(rafRef.current);\r\n      rafRef.current = null;\r\n      setIsPlaying(false);\r\n    }\r\n    if (intervalRef.current != null) {\r\n      clearInterval(intervalRef.current);\r\n      intervalRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const reset = useCallback(() => {\r\n    // Always reset to the start in forward direction to avoid flashes\r\n    // when previous run ended with reversed direction (e.g., yoyo cases).\r\n    pause();\r\n    dirRef.current = 1;\r\n    rawRef.current = 0;\r\n    const eased = ease(0);\r\n    setT(eased);\r\n  }, [ease, pause]);\r\n\r\n  const reverse = useCallback(() => {\r\n    dirRef.current = dirRef.current === 1 ? -1 : 1;\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (autoplay) play();\r\n    return () => {\r\n      if (rafRef.current != null) cancelAnimationFrame(rafRef.current);\r\n      if (intervalRef.current != null) clearInterval(intervalRef.current);\r\n    };\r\n  }, [autoplay, play]);\r\n\r\n  return { t, isPlaying, play, pause, reset, reverse };\r\n}\r\n","import React from \"react\";\r\nimport { EasingFn, EasingName, getEasing } from \"./easing\";\r\nimport { PlotContext } from \"./context\";\r\n\r\nexport type AnimationType2D = \"appear\" | \"disappear\" | \"transform\" | \"morph\";\r\n\r\nexport type Transform2D = {\r\n  x?: number;\r\n  y?: number;\r\n  scale?: number;\r\n  rotation?: number; // radians\r\n  opacity?: number;\r\n};\r\n\r\nexport type Animate2DProps = {\r\n  children?: React.ReactNode;\r\n  type?: AnimationType2D;\r\n  from?: Transform2D;\r\n  to?: Transform2D;\r\n  duration?: number;\r\n  delay?: number;\r\n  easing?: EasingName | EasingFn;\r\n  autoplay?: boolean;\r\n  loop?: boolean;\r\n  yoyo?: boolean;\r\n  replayKey?: any; // when this value changes, restart the animation\r\n  // For morph we could add fromNode/toNode props in future iterations.\r\n};\r\n\r\nfunction lerp(a: number, b: number, t: number) { return a + (b - a) * t; }\r\n\r\nexport function Animate2D({ children, type = \"transform\", from, to, duration = 600, delay = 0, easing = \"easeInOutCubic\", autoplay = true, loop = false, yoyo = false, replayKey }: Animate2DProps) {\r\n  const plot = React.useContext(PlotContext);\r\n  const easeFn: EasingFn = React.useMemo(() => typeof easing === 'function' ? easing : getEasing(easing), [easing]);\r\n  const defaults = React.useMemo(() => {\r\n    // Fade-only defaults for appear/disappear\r\n    if (type === \"appear\") return { from: { opacity: 0 }, to: { opacity: 1 } };\r\n    if (type === \"disappear\") return { from: { opacity: 1 }, to: { opacity: 0 } };\r\n    return { from: {}, to: {} };\r\n  }, [type]);\r\n\r\n  const outerRef = React.useRef<SVGGElement | null>(null);\r\n\r\n  const applyAt = React.useCallback((tt: number) => {\r\n    const g = outerRef.current; if (!g) return;\r\n    const f = { ...defaults.from, ...from } as Transform2D;\r\n    const t = { ...defaults.to, ...to } as Transform2D;\r\n    const wx = lerp(f.x ?? 0, t.x ?? 0, tt);\r\n    const wy = lerp(f.y ?? 0, t.y ?? 0, tt);\r\n    const sc = lerp(f.scale ?? 1, t.scale ?? 1, tt);\r\n    const rot = lerp(f.rotation ?? 0, t.rotation ?? 0, tt);\r\n    const opFrom = f.opacity ?? 1; const opTo = t.opacity ?? 1;\r\n    const op = lerp(opFrom, opTo, tt);\r\n    const rotDeg = rot * 180 / Math.PI;\r\n\r\n    // Map world translation to screen pixels if inside a Plot2D\r\n    let dx = wx, dy = wy;\r\n    if (plot) {\r\n      const o = plot.worldToScreen(0, 0);\r\n      const px = plot.worldToScreen(wx, 0);\r\n      const py = plot.worldToScreen(0, wy);\r\n      dx = px.x - o.x;\r\n      dy = py.y - o.y;\r\n    }\r\n    g.setAttribute('transform', `translate(${dx} ${dy}) scale(${sc}) rotate(${rotDeg})`);\r\n    if (typeof op === 'number') g.setAttribute('opacity', String(op));\r\n  }, [defaults.from, defaults.to, from, to, plot]);\r\n\r\n  // Interval-based driver (same policy as 3D) to avoid RAF throttling\r\n  const driverRef = React.useRef<{ playing: boolean; dir: 1 | -1; startAt: number; id: number | null }>({ playing: false, dir: 1, startAt: 0, id: null });\r\n  const stop = React.useCallback(() => {\r\n    const d = driverRef.current;\r\n    if (d.id != null) { clearInterval(d.id); d.id = null; }\r\n    d.playing = false;\r\n  }, []);\r\n  const play = React.useCallback(() => {\r\n    const d = driverRef.current;\r\n    if (d.playing) return;\r\n    d.playing = true; d.dir = 1;\r\n    const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n    d.startAt = now;\r\n    if (d.id != null) { clearInterval(d.id); d.id = null; }\r\n    d.id = window.setInterval(() => {\r\n      const tnow = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n      const elapsed = tnow - d.startAt;\r\n      const eff = elapsed - delay;\r\n      if (eff < 0) { applyAt(0); return; }\r\n      let raw = Math.min(Math.max(eff / duration, 0), 1);\r\n      if (d.dir < 0) raw = 1 - raw;\r\n      const eased = easeFn(raw);\r\n      applyAt(eased);\r\n      const finished = eff >= duration;\r\n      if (finished) {\r\n        if (loop) {\r\n          if (yoyo) d.dir = d.dir === 1 ? -1 : 1;\r\n          d.startAt = tnow;\r\n        } else {\r\n          stop();\r\n        }\r\n      }\r\n    }, 16);\r\n  }, [applyAt, delay, duration, easeFn, loop, stop, yoyo]);\r\n\r\n  // Reset + (re)start policy\r\n  const lastResetAtRef = React.useRef<number>(-1);\r\n  const resetPlay = React.useCallback(() => {\r\n    const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n    if (lastResetAtRef.current > 0 && (now - lastResetAtRef.current) < 250) return;\r\n    lastResetAtRef.current = now;\r\n    stop();\r\n    // Apply t=0 before first paint\r\n    applyAt(0);\r\n    if (autoplay) play();\r\n  }, [applyAt, autoplay, play, stop]);\r\n\r\n  // First mount and when type/replayKey changes\r\n  const initedRef = React.useRef(false);\r\n  React.useLayoutEffect(() => {\r\n    if (!initedRef.current) initedRef.current = true;\r\n    resetPlay();\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [type, replayKey]);\r\n\r\n  // Toggle autoplay without full reset (but still ensure freeze when off)\r\n  React.useLayoutEffect(() => {\r\n    if (autoplay) {\r\n      // if not playing, start from current 0 position\r\n      play();\r\n    } else {\r\n      stop();\r\n    }\r\n  }, [autoplay, play, stop]);\r\n\r\n  // Heuristic: if children are only intrinsic SVG elements (e.g., 'g', 'circle', 'rect'),\r\n  // assume their coordinates are in WORLD units and provide a mapping group.\r\n  const intrinsicOnly = React.useMemo(() => {\r\n    const arr = React.Children.toArray(children) as any[];\r\n    const isIntrinsic = (el: any): boolean => {\r\n      if (!React.isValidElement(el)) return true;\r\n      const t = (el as any).type;\r\n      if (typeof t === 'string') return true; // svg intrinsic\r\n      return false; // custom component -> we won't remap\r\n    };\r\n    return arr.every(isIntrinsic);\r\n  }, [children]);\r\n\r\n  let worldGroupTransform: string | null = null;\r\n  if (plot && intrinsicOnly) {\r\n    const o = plot.worldToScreen(0, 0);\r\n    const px = plot.worldToScreen(1, 0);\r\n    const py = plot.worldToScreen(0, 1);\r\n    const sx = px.x - o.x;\r\n    const sy = py.y - o.y; // usually negative (y up in world)\r\n    worldGroupTransform = `matrix(${sx} 0 0 ${sy} ${o.x} ${o.y})`;\r\n  }\r\n\r\n  const clipProps = plot ? { clipPath: `url(#${plot.clipPathId})` } : {};\r\n\r\n  // For appear, start with opacity 0 to avoid first-frame flash\r\n  const initialOpacity = type === 'appear' ? 0 : undefined;\r\n\r\n  return (\r\n    <g ref={outerRef} opacity={initialOpacity as any} {...clipProps}>\r\n      {worldGroupTransform ? (\r\n        <g transform={worldGroupTransform}>{children}</g>\r\n      ) : (\r\n        children as any\r\n      )}\r\n    </g>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { useThree } from \"./threeContext\";\r\nimport { ThreeParentContext, useThreeParent } from \"./threeParent\";\r\nimport { EasingFn, EasingName } from \"./easing\";\r\nimport { getEasing } from \"./easing\";\r\n\r\ntype Vec3 = [number, number, number];\r\n\r\nexport type AnimationType3D = \"appear\" | \"disappear\" | \"transform\";\r\n\r\nexport type Transform3D = {\r\n  position?: Vec3;\r\n  rotation?: Vec3; // Euler XYZ in radians\r\n  scale?: Vec3;\r\n};\r\n\r\nexport type Animate3DProps = {\r\n  children?: React.ReactNode;\r\n  type?: AnimationType3D;\r\n  from?: Transform3D;\r\n  to?: Transform3D;\r\n  duration?: number;\r\n  delay?: number;\r\n  easing?: EasingName | EasingFn;\r\n  autoplay?: boolean;\r\n  loop?: boolean;\r\n  yoyo?: boolean;\r\n  replayKey?: any; // when this value changes, restart the animation\r\n};\r\n\r\nfunction lerp(a: number, b: number, t: number) { return a + (b - a) * t; }\r\nfunction lerp3(a: Vec3 | undefined, b: Vec3 | undefined, t: number, fallback: Vec3): Vec3 {\r\n  const aa = a ?? fallback;\r\n  const bb = b ?? fallback;\r\n  return [lerp(aa[0], bb[0], t), lerp(aa[1], bb[1], t), lerp(aa[2], bb[2], t)];\r\n}\r\n\r\nexport function Animate3D({ children, type = \"transform\", from, to, duration = 800, delay = 0, easing = \"easeInOutCubic\", autoplay = true, loop = false, yoyo = false, replayKey }: Animate3DProps) {\r\n  const { THREE, scene } = useThree();\r\n  const parent = useThreeParent();\r\n  const easeFn: EasingFn = React.useMemo(() => typeof easing === 'function' ? easing : getEasing(easing), [easing]);\r\n\r\n  const groupRef = React.useRef<any>(null);\r\n  const [ready, setReady] = React.useState(false);\r\n  const [childrenReadyTick, setChildrenReadyTick] = React.useState(0);\r\n\r\n  // Create a group and mount it under current three parent (or scene)\r\n  React.useEffect(() => {\r\n    if (!THREE || !scene) return;\r\n    const g = new THREE.Group();\r\n    // Start hidden for appear to avoid first-frame flash\r\n    if (type === 'appear') g.visible = false;\r\n    (parent ?? scene).add(g);\r\n    groupRef.current = g;\r\n    setReady(true);\r\n    return () => {\r\n      try { (parent ?? scene).remove(g); } catch {}\r\n      groupRef.current = null;\r\n      setReady(false);\r\n    };\r\n  // parent shouldn't change often; re-create if context changes\r\n  }, [THREE, scene, parent]);\r\n\r\n  // Helper: traverse meshes within group\r\n  const traverseMeshes = React.useCallback((root: any, fn?: (mesh: any, material: any, idx: number | null) => void) => {\r\n    if (!root) return false;\r\n    let found = false;\r\n    root.traverse?.((obj: any) => {\r\n      if (!obj || !obj.isMesh) return;\r\n      found = true;\r\n      if (!fn) return;\r\n      const mat = obj.material;\r\n      if (Array.isArray(mat)) {\r\n        mat.forEach((m, i) => fn(obj, m, i));\r\n      } else if (mat) {\r\n        fn(obj, mat, null);\r\n      }\r\n    });\r\n    return found;\r\n  }, []);\r\n\r\n  // Material preparation to avoid shared-material flicker during fades\r\n  const preparedRef = React.useRef(false);\r\n  const finalizeOnAppearRef = React.useRef(false);\r\n  const appearRunningRef = React.useRef(false);\r\n  const appearWatchRef = React.useRef<number | null>(null);\r\n  const currentProgressRef = React.useRef(0);\r\n  const prepareMaterials = React.useCallback((initialOpacity: number) => {\r\n    const g = groupRef.current; if (!g) return;\r\n    if (preparedRef.current) return;\r\n    traverseMeshes(g, (mesh, material, idx) => {\r\n      // Skip if already prepared\r\n      if (mesh.userData?.__anim3dPrepared) return;\r\n      // Clone material to avoid mutating shared instances\r\n      let cloned: any;\r\n      try { cloned = material.clone?.() ?? material; } catch { cloned = material; }\r\n      const orig = material;\r\n      const originalTransparent = !!orig.transparent;\r\n      const originalDepthWrite = !!orig.depthWrite;\r\n      // Assign cloned material\r\n      if (idx == null) mesh.material = cloned; else mesh.material[idx] = cloned;\r\n      // Configure for fade\r\n      try {\r\n        cloned.transparent = true;\r\n        cloned.depthWrite = false;\r\n        if (typeof cloned.opacity === 'number') cloned.opacity = initialOpacity;\r\n      } catch {}\r\n      mesh.userData = mesh.userData || {};\r\n      mesh.userData.__anim3dPrepared = { orig, originalTransparent, originalDepthWrite, idx };\r\n    });\r\n    preparedRef.current = true;\r\n  }, [traverseMeshes]);\r\n\r\n  const finalizeMaterials = React.useCallback(() => {\r\n    const g = groupRef.current; if (!g) return;\r\n    if (!preparedRef.current) return;\r\n    traverseMeshes(g, (mesh, material) => {\r\n      const info = mesh.userData?.__anim3dPrepared;\r\n      if (!info) return;\r\n      // Restore original where possible; else at least set solid flags back\r\n      try {\r\n        if (mesh.material && info.orig) {\r\n          // Assign back the original material instance\r\n          mesh.material = info.orig;\r\n        }\r\n      } catch {}\r\n      try {\r\n        if (material) {\r\n          material.transparent = info.originalTransparent;\r\n          material.depthWrite = info.originalDepthWrite;\r\n        }\r\n      } catch {}\r\n      delete mesh.userData.__anim3dPrepared;\r\n    });\r\n    preparedRef.current = false;\r\n  }, [traverseMeshes]);\r\n\r\n  // Interpolation and application\r\n  const applyAt = React.useCallback((tt: number) => {\r\n    const g = groupRef.current; if (!g) return;\r\n    currentProgressRef.current = tt;\r\n    // Interpolate transforms\r\n    const fpos = from?.position ?? [0,0,0];\r\n    const tpos = to?.position ?? [0,0,0];\r\n    const frot = from?.rotation ?? [0,0,0];\r\n    const trot = to?.rotation ?? [0,0,0];\r\n    const fsca = from?.scale ?? [1,1,1];\r\n    const tsca = to?.scale ?? [1,1,1];\r\n    const p = lerp3(fpos as Vec3, tpos as Vec3, tt, [0,0,0]);\r\n  const r = lerp3(frot as Vec3, trot as Vec3, tt, [0,0,0]);\r\n    const s = lerp3(fsca as Vec3, tsca as Vec3, tt, [1,1,1]);\r\n    g.position.set(p[0], p[1], p[2]);\r\n  // Invert Y to match visual expectation: positive yaw rotates to the right on screen\r\n  g.rotation.set(r[0], -r[1], r[2]);\r\n    g.scale.set(s[0], s[1], s[2]);\r\n\r\n    // Opacity fade for appear/disappear\r\n    if (type === 'appear' || type === 'disappear') {\r\n      const op = type === 'appear' ? tt : (1 - tt);\r\n      traverseMeshes(g, (_mesh, material) => {\r\n        try { if (typeof material.opacity === 'number') material.opacity = op; } catch {}\r\n      });\r\n    }\r\n  }, [from?.position, from?.rotation, from?.scale, to?.position, to?.rotation, to?.scale, type, traverseMeshes]);\r\n\r\n  // Interval-based driver independent of RAF\r\n  const driverRef = React.useRef<{ playing: boolean; dir: 1 | -1; startAt: number; id: number | null }>({ playing: false, dir: 1, startAt: 0, id: null });\r\n  const stop = React.useCallback(() => {\r\n    const d = driverRef.current;\r\n    if (d.id != null) { clearInterval(d.id); d.id = null; }\r\n    d.playing = false;\r\n  }, []);\r\n  const play = React.useCallback(() => {\r\n    const d = driverRef.current;\r\n    if (d.playing) return;\r\n    d.playing = true; d.dir = 1;\r\n    const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n    d.startAt = now;\r\n    if (d.id != null) { clearInterval(d.id); d.id = null; }\r\n    d.id = window.setInterval(() => {\r\n      const tnow = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n      const elapsed = tnow - d.startAt;\r\n      const eff = elapsed - (delay ?? 0);\r\n      if (eff < 0) { applyAt(0); return; }\r\n      let raw = Math.min(Math.max(eff / (duration || 1), 0), 1);\r\n      if (d.dir < 0) raw = 1 - raw;\r\n      const eased = easeFn(raw);\r\n      applyAt(eased);\r\n      const finished = eff >= (duration || 1);\r\n      if (finished) {\r\n        if (loop) {\r\n          if (yoyo) d.dir = d.dir === 1 ? -1 : 1;\r\n          d.startAt = tnow;\r\n        } else {\r\n          stop();\r\n          // Finalize materials after appear completes\r\n          if (type === 'appear') finalizeOnAppearRef.current = true;\r\n          appearRunningRef.current = false;\r\n          if (appearWatchRef.current != null) { clearInterval(appearWatchRef.current); appearWatchRef.current = null; }\r\n        }\r\n      }\r\n    }, 16);\r\n  }, [applyAt, delay, duration, easeFn, loop, stop, type, yoyo]);\r\n\r\n  // Debounced reset + start policy\r\n  const lastResetAtRef = React.useRef<number>(-1);\r\n  const rafRevealRef = React.useRef<number | null>(null);\r\n  const pollTimerRef = React.useRef<number | null>(null);\r\n  const resetPlay = React.useCallback(() => {\r\n    const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n    if (lastResetAtRef.current > 0 && (now - lastResetAtRef.current) < 250) return;\r\n    lastResetAtRef.current = now;\r\n    stop();\r\n    finalizeMaterials();\r\n    const g = groupRef.current;\r\n    if (!g) return;\r\n\r\n    // Appear: start hidden, prep materials at opacity=0, apply t=0, then reveal next frame (after children mount)\r\n    if (type === 'appear') {\r\n      g.visible = false;\r\n      appearRunningRef.current = true;\r\n\r\n      const startWatcher = () => {\r\n        // While appear is running, prepare any late-added meshes to current opacity\r\n        if (appearWatchRef.current != null) { clearInterval(appearWatchRef.current); }\r\n        appearWatchRef.current = window.setInterval(() => {\r\n          const root = groupRef.current; if (!root) return;\r\n          traverseMeshes(root, (mesh, material, idx) => {\r\n            if (mesh.userData?.__anim3dPrepared) return;\r\n            // Prepare this late mesh\r\n            let cloned: any;\r\n            try { cloned = material.clone?.() ?? material; } catch { cloned = material; }\r\n            const orig = material;\r\n            const originalTransparent = !!orig.transparent;\r\n            const originalDepthWrite = !!orig.depthWrite;\r\n            if (idx == null) mesh.material = cloned; else mesh.material[idx] = cloned;\r\n            try {\r\n              cloned.transparent = true; cloned.depthWrite = false; cloned.opacity = currentProgressRef.current;\r\n              cloned.needsUpdate = true;\r\n            } catch {}\r\n            mesh.userData = mesh.userData || {};\r\n            mesh.userData.__anim3dPrepared = { orig, originalTransparent, originalDepthWrite, idx };\r\n          });\r\n        }, 40);\r\n      };\r\n\r\n      const kick = () => {\r\n        prepareMaterials(0);\r\n        applyAt(0);\r\n        if (rafRevealRef.current != null) cancelAnimationFrame(rafRevealRef.current);\r\n        rafRevealRef.current = requestAnimationFrame(() => {\r\n          g.visible = true;\r\n          startWatcher();\r\n          if (autoplay) play();\r\n        });\r\n      };\r\n\r\n      // Wait until at least one mesh exists; fallback after 2000ms\r\n      if (pollTimerRef.current != null) clearTimeout(pollTimerRef.current);\r\n      const start = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n      const poll = () => {\r\n        if (!groupRef.current) return;\r\n        const hasMesh = traverseMeshes(groupRef.current);\r\n        const tnow = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\r\n        if (hasMesh || (tnow - start) > 2000) {\r\n          kick();\r\n        } else {\r\n          pollTimerRef.current = window.setTimeout(poll, 16) as any;\r\n        }\r\n      };\r\n      poll();\r\n      return;\r\n    }\r\n\r\n    // Disappear: ensure materials prepared at opacity=1, then run\r\n    if (type === 'disappear') {\r\n      g.visible = true;\r\n      prepareMaterials(1);\r\n      applyAt(0);\r\n      if (autoplay) play();\r\n      return;\r\n    }\r\n\r\n    // Transform: just apply t=0 and go\r\n    g.visible = true;\r\n    applyAt(0);\r\n    if (autoplay) play();\r\n  }, [applyAt, autoplay, finalizeMaterials, play, prepareMaterials, stop, type]);\r\n\r\n  // On first mount and when type/replayKey changes\r\n  const initedRef = React.useRef(false);\r\n  React.useLayoutEffect(() => {\r\n    if (!ready) return;\r\n    if (!initedRef.current) initedRef.current = true;\r\n    resetPlay();\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [ready, type, replayKey]);\r\n\r\n  // Watch autoplay toggles without full reset\r\n  React.useLayoutEffect(() => {\r\n    if (!ready) return;\r\n    if (autoplay) {\r\n      play();\r\n    } else {\r\n      stop();\r\n    }\r\n  }, [autoplay, play, ready, stop]);\r\n\r\n  // After each render where children count might change, bump a tick to allow appear polling to resume quicker\r\n  React.useEffect(() => {\r\n    if (!ready || !groupRef.current) return;\r\n    setChildrenReadyTick((t) => t + 1);\r\n    // no cleanup\r\n  }, [children, ready]);\r\n\r\n  // Finalization after appear complete on next effect tick\r\n  React.useEffect(() => {\r\n    if (!finalizeOnAppearRef.current) return;\r\n    finalizeOnAppearRef.current = false;\r\n    // Restore solid flags soon after finishing\r\n    finalizeMaterials();\r\n  });\r\n\r\n  // Cleanup timers on unmount\r\n  React.useEffect(() => {\r\n    return () => {\r\n      try { stop(); } catch {}\r\n      if (rafRevealRef.current != null) cancelAnimationFrame(rafRevealRef.current);\r\n      if (pollTimerRef.current != null) clearTimeout(pollTimerRef.current);\r\n      if (appearWatchRef.current != null) { clearInterval(appearWatchRef.current); appearWatchRef.current = null; }\r\n      appearRunningRef.current = false;\r\n      try { finalizeMaterials(); } catch {}\r\n    };\r\n  }, [finalizeMaterials, stop]);\r\n\r\n  if (!groupRef.current || !ready) return null;\r\n  return (\r\n    <ThreeParentContext.Provider value={groupRef.current}>\r\n      {children}\r\n    </ThreeParentContext.Provider>\r\n  );\r\n}\r\n"],"mappings":"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","names":["React","React","nx","ny","m","jsx","jsxs","React","jsx","React","React","jsx","React","React","jsx","jsxs","React","jsx","jsxs","jsx","jsx","jsx","jsx","React","jsx","React","jsx","jsx","jsxs","React","jsx","React","React","jsx","React","React","jsx","React","React","jsx","React","rects","jsx","jsx","jsx","jsx","jsxs","React","jsx","React","React","jsx","React","React","jsx","React","jsx","jsx","jsx","jsxs","jsx","jsxs","jsx","React","jsx","jsxs","React","jsxs","jsx","React","jsx","jsxs","React","React","jsx","jsxs","React","React","React","jsx","jsxs","React","_a","_b","_c","React","React","React","group","cleanups","React","React","React","React","React","React","React","jsx","React","jsx","jsxs","React","React","React","React","React","React","React","React","React","React","React","React","React","React","jsx","React","React","jsx","lerp","easing","React","React","jsx","lerp","lerp3","easing","React"]}